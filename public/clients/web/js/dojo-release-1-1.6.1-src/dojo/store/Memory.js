define("dojo/store/Memory",["dojo","dojo/store/util/QueryResults","dojo/store/util/SimpleQueryEngine"],function(a){a.declare("dojo.store.Memory",null,{constructor:function(b){this.index={},a.mixin(this,b),this.setData(this.data||[])},data:null,idProperty:"id",index:null,queryEngine:a.store.util.SimpleQueryEngine,get:function(a){return this.index[a]},getIdentity:function(a){return a[this.idProperty]},put:function(a,b){var c=b&&b.id||a[this.idProperty]||Math.random();this.index[c]=a;var d=this.data,e=this.idProperty;for(var f=0,g=d.length;f<g;f++)if(d[f][e]==c){d[f]=a;return c}this.data.push(a);return c},add:function(a,b){if(this.index[b&&b.id||a[this.idProperty]])throw new Error("Object already exists");return this.put(a,b)},remove:function(a){delete this.index[a];var b=this.data,c=this.idProperty;for(var d=0,e=b.length;d<e;d++)if(b[d][c]==a){b.splice(d,1);return}},query:function(b,c){return a.store.util.QueryResults(this.queryEngine(b,c)(this.data))},setData:function(a){a.items?(this.idProperty=a.identifier,a=this.data=a.items):this.data=a;for(var b=0,c=a.length;b<c;b++){var d=a[b];this.index[d[this.idProperty]]=d}}});return a.store.Memory})