define("tests/data/readOnlyItemFileTestTemplates",["dojo/data/api/Read","dojo/data/api/Identity","dojo/date","dojo/date/stamp"],function(){dojo.getObject("data.readOnlyItemFileTestTemplates",!0,tests),dojo.declare("tests.data.Wrapper",null,{_wrapped:null,constructor:function(a){this._wrapped=a},getValue:function(){return this._wrapped},setValue:function(a){this._wrapped=a},toString:function(){return"WRAPPER: ["+this._wrapped+"]"}}),tests.data.readOnlyItemFileTestTemplates.registerTestsForDatastore=function(a){var b=dojo.getObject(a),c=tests.data.readOnlyItemFileTestTemplates.testTemplates,d=[],e=function(a){return function(c){return a.runTest(b,c)}};for(var f=0;f<c.length;++f){var g=c[f],h={};h.name=g.name,h.runTest=e(g),d.push(h)}var i="IFSCommonTests: "+a;doh.register(i,d)},tests.data.readOnlyItemFileTestTemplates.getTestData=function(a){var b=null;a==="countries"?dojo.isBrowser?b={url:dojo.moduleUrl("tests","data/countries.json").toString()}:b={data:{identifier:"abbr",label:"name",items:[{abbr:"ec",name:"Ecuador",capital:"Quito"},{abbr:"eg",name:"Egypt",capital:"Cairo"},{abbr:"sv",name:"El Salvador",capital:"San Salvador"},{abbr:"gq",name:"Equatorial Guinea",capital:"Malabo"},{abbr:"er",name:"Eritrea",capital:"Asmara"},{abbr:"ee",name:"Estonia",capital:"Tallinn"},{abbr:"et",name:"Ethiopia",capital:"Addis Ababa"}]}}:a==="countries_withNull"?dojo.isBrowser?b={url:dojo.moduleUrl("tests","data/countries_withNull.json").toString()}:b={data:{identifier:"abbr",items:[{abbr:"ec",name:null,capital:"Quito"},{abbr:"eg",name:null,capital:"Cairo"},{abbr:"sv",name:"El Salvador",capital:"San Salvador"},{abbr:"gq",name:"Equatorial Guinea",capital:"Malabo"},{abbr:"er",name:"Eritrea",capital:"Asmara"},{abbr:"ee",name:null,capital:"Tallinn"},{abbr:"et",name:"Ethiopia",capital:"Addis Ababa"}]}}:a==="countries_withoutid"?dojo.isBrowser?b={url:dojo.moduleUrl("tests","data/countries_withoutid.json").toString()}:b={data:{label:"name",items:[{abbr:"ec",name:null,capital:"Quito"},{abbr:"eg",name:null,capital:"Cairo"},{abbr:"sv",name:"El Salvador",capital:"San Salvador"},{abbr:"gq",name:"Equatorial Guinea",capital:"Malabo"},{abbr:"er",name:"Eritrea",capital:"Asmara"},{abbr:"ee",name:null,capital:"Tallinn"},{abbr:"et",name:"Ethiopia",capital:"Addis Ababa"}]}}:a==="countries_withBoolean"?dojo.isBrowser?b={url:dojo.moduleUrl("tests","data/countries_withBoolean.json").toString()}:b={data:{identifier:"abbr",items:[{abbr:"ec",name:"Ecuador",capital:"Quito",real:!0},{abbr:"eg",name:"Egypt",capital:"Cairo",real:!0},{abbr:"sv",name:"El Salvador",capital:"San Salvador",real:!0},{abbr:"gq",name:"Equatorial Guinea",capital:"Malabo",real:!0},{abbr:"er",name:"Eritrea",capital:"Asmara",real:!0},{abbr:"ee",name:"Estonia",capital:"Tallinn",real:!0},{abbr:"et",name:"Ethiopia",capital:"Addis Ababa",real:!0},{abbr:"ut",name:"Utopia",capital:"Paradise",real:!1}]}}:a==="countries_withDates"?dojo.isBrowser?b={url:dojo.moduleUrl("tests","data/countries_withDates.json").toString()}:b={data:{identifier:"abbr",items:[{abbr:"ec",name:"Ecuador",capital:"Quito"},{abbr:"eg",name:"Egypt",capital:"Cairo"},{abbr:"sv",name:"El Salvador",capital:"San Salvador"},{abbr:"gq",name:"Equatorial Guinea",capital:"Malabo"},{abbr:"er",name:"Eritrea",capital:"Asmara",independence:{_type:"Date",_value:"1993-05-24T00:00:00Z"}},{abbr:"ee",name:"Estonia",capital:"Tallinn",independence:{_type:"Date",_value:"1991-08-20T00:00:00Z"}},{abbr:"et",name:"Ethiopia",capital:"Addis Ababa"}]}}:a==="geography_hierarchy_small"?dojo.isBrowser?b={url:dojo.moduleUrl("tests","data/geography_hierarchy_small.json").toString()}:b={data:{items:[{name:"Africa",countries:[{name:"Egypt",capital:"Cairo"},{name:"Kenya",capital:"Nairobi"},{name:"Sudan",capital:"Khartoum"}]},{name:"Australia",capital:"Canberra"},{name:"North America",countries:[{name:"Canada",population:"33 million",cities:[{name:"Toronto",population:"2.5 million"},{name:"Alberta",population:"1 million"}]},{name:"United States of America",capital:"Washington DC",states:[{name:"Missouri"},{name:"Arkansas"}]}]}]}}:a==="data_multitype"?dojo.isBrowser?b={url:dojo.moduleUrl("tests","data/data_multitype.json").toString()}:b={data:{identifier:"count",label:"count",items:[{count:1,value:"true"},{count:2,value:!0},{count:3,value:"false"},{count:4,value:!1},{count:5,value:!0},{count:6,value:!0},{count:7,value:"true"},{count:8,value:"true"},{count:9,value:"false"},{count:10,value:!1},{count:11,value:[!1,!1]},{count:"12",value:[!1,"true"]}]}}:a==="countries_references"&&(dojo.isBrowser?b={url:dojo.moduleUrl("tests","data/countries_references.json").toString()}:b={data:{identifier:"name",label:"name",items:[{name:"Africa",type:"continent",children:[{_reference:"Egypt"},{_reference:"Kenya"},{_reference:"Sudan"}]},{name:"Egypt",type:"country"},{name:"Kenya",type:"country",children:[{_reference:"Nairobi"},{_reference:"Mombasa"}]},{name:"Nairobi",type:"city"},{name:"Mombasa",type:"city"},{name:"Sudan",type:"country",children:{_reference:"Khartoum"}},{name:"Khartoum",type:"city"},{name:"Asia",type:"continent",children:[{_reference:"China"},{_reference:"India"},{_reference:"Russia"},{_reference:"Mongolia"}]},{name:"China",type:"country"},{name:"India",type:"country"},{name:"Russia",type:"country"},{name:"Mongolia",type:"country"},{name:"Australia",type:"continent",population:"21 million",children:{_reference:"Commonwealth of Australia"}},{name:"Commonwealth of Australia",type:"country",population:"21 million"},{name:"Europe",type:"continent",children:[{_reference:"Germany"},{_reference:"France"},{_reference:"Spain"},{_reference:"Italy"}]},{name:"Germany",type:"country"},{name:"France",type:"country"},{name:"Spain",type:"country"},{name:"Italy",type:"country"},{name:"North America",type:"continent",children:[{_reference:"Mexico"},{_reference:"Canada"},{_reference:"United States of America"}]},{name:"Mexico",type:"country",population:"108 million",area:"1,972,550 sq km",children:[{_reference:"Mexico City"},{_reference:"Guadalajara"}]},{name:"Mexico City",type:"city",population:"19 million",timezone:"-6 UTC"},{name:"Guadalajara",type:"city",population:"4 million",timezone:"-6 UTC"},{name:"Canada",type:"country",population:"33 million",area:"9,984,670 sq km",children:[{_reference:"Ottawa"},{_reference:"Toronto"}]},{name:"Ottawa",type:"city",population:"0.9 million",timezone:"-5 UTC"},{name:"Toronto",type:"city",population:"2.5 million",timezone:"-5 UTC"},{name:"United States of America",type:"country"},{name:"South America",type:"continent",children:[{_reference:"Brazil"},{_reference:"Argentina"}]},{name:"Brazil",type:"country",population:"186 million"},{name:"Argentina",type:"country",population:"40 million"}]}});return b},tests.data.readOnlyItemFileTestTemplates.testTemplates=[{name:"Identity API: fetchItemByIdentity()",runTest:function(a,b){function f(a){b.assertTrue(!1),d.errback(a)}function e(a){b.assertTrue(a!==null);if(a!==null){var e=c.getValue(a,"name");b.assertEqual(e,"El Salvador")}d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),d=new doh.Deferred;c.fetchItemByIdentity({identity:"sv",onItem:e,onError:f});return d}},{name:"Identity API: fetchItemByIdentity() preventCache",runTest:function(a,b){function g(a){b.assertTrue(!1),e.errback(a)}function f(a){b.assertTrue(a!==null);if(a!==null){var c=d.getValue(a,"name");b.assertEqual(c,"El Salvador")}e.callback(!0)}var c=tests.data.readOnlyItemFileTestTemplates.getTestData("countries");c.urlPreventCache=!0;var d=new a(c),e=new doh.Deferred;d.fetchItemByIdentity({identity:"sv",onItem:f,onError:g});return e}},{name:"Identity API: fetchItemByIdentity() notFound",runTest:function(a,b){function f(a){b.assertTrue(!1),d.errback(a)}function e(a){b.assertTrue(a===null),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),d=new doh.Deferred;c.fetchItemByIdentity({identity:"sv_not",onItem:e,onError:f});return d}},{name:"Identity API: getIdentityAttributes()",runTest:function(a,b){function f(a){b.assertTrue(!1),d.errback(a)}function e(a){b.assertTrue(a!==null);var e=c.getIdentityAttributes(a);b.assertTrue(dojo.isArray(e)),b.assertEqual(1,e.length),b.assertEqual("abbr",e[0]),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),d=new doh.Deferred;c.fetchItemByIdentity({identity:"sv",onItem:e,onError:f});return d}},{name:"Identity API: fetchItemByIdentity() commentFilteredJson",runTest:function(a,b){if(dojo.isBrowser){var c=new a({url:dojo.moduleUrl("tests","data/countries_commentFiltered.json").toString()}),d=new doh.Deferred;function e(a){b.assertTrue(a!==null);var e=c.getValue(a,"name");b.assertEqual(e,"El Salvador"),d.callback(!0)}function f(a){b.assertTrue(!1),d.errback(a)}c.fetchItemByIdentity({identity:"sv",onItem:e,onError:f});return d}}},{name:"Identity API: fetchItemByIdentity() nullValue",runTest:function(a,b){function f(a){b.assertTrue(!1),d.errback(a)}function e(a){b.assertTrue(a!==null);var e=c.getValue(a,"name");b.assertEqual(e,null),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries_withNull")),d=new doh.Deferred;c.fetchItemByIdentity({identity:"ec",onItem:e,onError:f});return d}},{name:"Identity API: fetchItemByIdentity() booleanValue",runTest:function(a,b){function f(a){b.assertTrue(!1),d.errback(a)}function e(a){b.assertTrue(a!==null);var e=c.getValue(a,"name");b.assertEqual(e,"Utopia");var f=c.getValue(a,"real");b.assertEqual(f,!1),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries_withBoolean")),d=new doh.Deferred;c.fetchItemByIdentity({identity:"ut",onItem:e,onError:f});return d}},{name:"Identity API: fetchItemByIdentity() withoutSpecifiedIdInData",runTest:function(a,b){function f(a){b.assertTrue(!1),d.errback(a)}function e(a){b.assertTrue(a!==null);var e=c.getValue(a,"name");b.assertEqual(e,"El Salvador"),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries_withoutid")),d=new doh.Deferred;c.fetchItemByIdentity({identity:"2",onItem:e,onError:f});return d}},{name:"Identity API: fetchItemByIdentity() Object.prototype item identifier",runTest:function(a,b){function g(a){b.assertTrue(!1),e.errback(a)}function f(a){b.assertTrue(a.value=="aha"),e.callback(!0)}var c={identifier:"id",items:[{id:"toString",value:"aha"}]},d=new a({data:c}),e=new doh.Deferred;d.fetchItemByIdentity({identity:"toString",onItem:f,onError:g});return e}},{name:"Identity API: fetchItemByIdentity() Object.prototype item identifier 2",runTest:function(a,b){function g(a){b.assertTrue(!1),e.errback(a)}function f(a){b.assertTrue(a.value=="yep"),e.callback(!0)}var c={identifier:"id",items:[{id:"hasOwnProperty",value:"yep"}]},d=new a({data:c}),e=new doh.Deferred;d.fetchItemByIdentity({identity:"hasOwnProperty",onItem:f,onError:g});return e}},{name:"Identity API: fetchItemByIdentity() Object.prototype identity",runTest:function(a,b){function f(a){b.assertTrue(!1),d.errback(a)}function e(a){b.assertTrue(a===null),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries_withoutid")),d=new doh.Deferred;c.fetchItemByIdentity({identity:"toString",onItem:e,onError:f});return d}},{name:"Identity API: fetchItemByIdentity() Object.prototype identity 2",runTest:function(a,b){function f(a){b.assertTrue(!1),d.errback(a)}function e(a){b.assertTrue(a===null),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries_withoutid")),d=new doh.Deferred;c.fetchItemByIdentity({identity:"hasOwnProperty",onItem:e,onError:f});return d}},{name:"Identity API: getIdentity()",runTest:function(a,b){function f(a){b.assertTrue(!1),d.errback(a)}function e(a){b.assertTrue(a!==null),b.assertTrue(c.getIdentity(a)==="sv"),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),d=new doh.Deferred;c.fetchItemByIdentity({identity:"sv",onItem:e,onError:f});return d}},{name:"Identity API: getIdentity() withoutSpecifiedId",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,e){b.assertTrue(a!==null),b.assertTrue(c.getIdentity(a)===2),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries_withoutid")),d=new doh.Deferred;c.fetch({query:{abbr:"sv"},onItem:e,onError:f});return d}},{name:"Read API: fetch() all",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,c){b.is(7,a.length),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),d=new doh.Deferred;c.fetch({onComplete:e,onError:f});return d}},{name:"Read API: fetch() all failOk",runTest:function(a,b){if(dojo.isBrowser){var c={url:"noSuchUrl",failOk:!0},d=new a(c);console.log(d);var e=new doh.Deferred,f=function(a,b){e.errback(new Error("Should not be here, should have failed load."))},g=function(a,b){e.callback(!0)};d.fetch({onComplete:f,onError:g});return e}}},{name:"Read API: fetch() abort",runTest:function(a,b){if(dojo.isBrowser){var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),d=new doh.Deferred,e=!1;function f(a,c){b.is(7,a.length),e?(console.log("Made it to complete callback and abort was called.  Problem."),d.errback(new Error("Should not be here."))):(console.log("in onComplete and abort has not been called.  Timing.  This is okay."),d.callback(!0))}function g(a,c){b.assertTrue(!0),d.callback(!0)}var h=c.fetch({onComplete:f,onError:g});e=!0,console.log("Calling abort."),h.abort();return d}}},{name:"Read API: fetch() all (count === Infinity)",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,c){b.is(7,a.length),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),d=new doh.Deferred;c.fetch({onComplete:e,onError:f,start:0,count:Infinity});return d}},{name:"Read API: fetch() all PreventCache",runTest:function(a,b){function g(a,c){b.assertTrue(!1),e.errback(a)}function f(a,c){b.is(7,a.length),e.callback(!0)}var c=tests.data.readOnlyItemFileTestTemplates.getTestData("countries");c.urlPreventCache=!0;var d=new a(c),e=new doh.Deferred;d.fetch({onComplete:f,onError:g});return e}},{name:"Read API: fetch() one",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,c){b.assertEqual(a.length,1),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),d=new doh.Deferred;c.fetch({query:{abbr:"ec"},onComplete:e,onError:f});return d}},{name:"Read API: fetch() shallow",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,c){b.assertEqual(a.length,2),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("geography_hierarchy_small")),d=new doh.Deferred;c.fetch({query:{name:"A*"},onComplete:e,onError:f});return d}},{name:"Read API: fetch() Multiple",runTest:function(a,b){function h(a,c){b.assertTrue(!1),d.errback(a)}function g(a,b){e[1]=!0,e[0]&&e[1]&&d.callback(!0)}function f(a,c){e[0]=!0,b.assertEqual(a.length,2),e[0]&&e[1]&&d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("geography_hierarchy_small")),d=new doh.Deferred,e=[!1,!1];c.fetch({query:{name:"A*"},onComplete:f,onError:h}),c.fetch({query:{name:"N*"},onComplete:g,onError:h});return d}},{name:"Read API: fetch() MultipleMixedFetch",runTest:function(a,b){function h(a){b.assertTrue(!1),d.errback(a)}function g(a){e[1]=!0,b.assertTrue(a!==null);var f=c.getValue(a,"name");b.assertEqual(f,"El Salvador"),e[0]&&e[1]&&d.callback(!0)}function f(a,c){e[0]=!0,b.assertEqual(a.length,1),e[0]&&e[1]&&d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),d=new doh.Deferred,e=[!1,!1];c.fetch({query:{name:"El*"},onComplete:f,onError:h}),c.fetchItemByIdentity({identity:"sv",onItem:g,onError:h});return d}},{name:"Read API: fetch() deep",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,c){b.assertEqual(a.length,4),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("geography_hierarchy_small")),d=new doh.Deferred;c.fetch({query:{name:"A*"},onComplete:e,onError:f,queryOptions:{deep:!0}});return d}},{name:"Read API: fetch() hierarchy off",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,e){b.assertEqual(a.length,2);var f,g=!0;for(f=0;f<a.length;f++){var h=c.getValues(a[f],"countries");if(h){var i;for(i=0;i<h.length;i++){g=!c.isItem(h[i]);if(!g)break}}if(!g)break}g?d.callback(!0):d.errback(new Error("Located a child item with hierarchy off and no references in the data.  Error."))}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("geography_hierarchy_small"));c.hierarchical=!1;var d=new doh.Deferred;c.fetch({query:{name:"A*"},onComplete:e,onError:f,queryOptions:{deep:!0}});return d}},{name:"Read API: fetch() hierarchy off refs still parse",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,e){b.assertEqual(a.length,4);var f,g=!0;for(f=0;f<a.length;f++){var h=c.getValues(a[f],"children");if(h){var i;for(i=0;i<h.length;i++){g=c.isItem(h[i]);if(!g)break}}if(!g)break}g?d.callback(!0):d.errback(new Error("Found a non-child item in a reference list in a references based input.  Error."))}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries_references"));c.hierarchical=!1;var d=new doh.Deferred;c.fetch({query:{name:"A*"},onComplete:e,onError:f,queryOptions:{deep:!0}});return d}},{name:"Read API: fetch() one_commentFilteredJson",runTest:function(a,b){if(dojo.isBrowser){var c=new a({url:dojo.moduleUrl("tests","data/countries_commentFiltered.json").toString()}),d=new doh.Deferred;function e(a,c){b.assertEqual(a.length,1),d.callback(!0)}function f(a,c){b.assertTrue(!1),d.errback(a)}c.fetch({query:{abbr:"ec"},onComplete:e,onError:f});return d}}},{name:"Read API: fetch() withNull",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,c){b.assertEqual(4,a.length),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries_withNull")),d=new doh.Deferred;c.fetch({query:{name:"E*"},onComplete:e,onError:f});return d}},{name:"Read API: fetch() all_streaming",runTest:function(a,b){function h(a,c){b.assertTrue(!1),d.errback(a)}function g(a,c){b.assertEqual(count,7),b.assertTrue(a===null),d.callback(!0)}function f(a,d){b.assertTrue(c.isItem(a)),count++}function e(a,c){b.assertEqual(a,7)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),d=new doh.Deferred;count=0,c.fetch({onBegin:e,onItem:f,onComplete:g,onError:h});return d}},{name:"Read API: fetch() paging",runTest:function(a,b){function l(a,c){b.assertTrue(!1),d.errback(a)}function k(a,d){b.assertEqual(a.length,7),d.start=1,d.count=5,d.onComplete=e,c.fetch(d)}function j(a,c){b.assertEqual(a.length,5),d.callback(!0)}function i(a,d){b.assertEqual(a.length,0),d.start=2,d.count=20,d.onComplete=j,c.fetch(d)}function h(a,d){b.assertEqual(a.length,5),d.start=9,d.count=100,d.onComplete=i,c.fetch(d)}function g(a,d){b.assertEqual(a.length,5),d.start=2,d.count=20,d.onComplete=h,c.fetch(d)}function f(a,d){b.assertEqual(a.length,1),d.start=0,d.count=5,d.onComplete=g,c.fetch(d)}function e(a,d){b.assertEqual(a.length,5),d.start=3,d.count=1,d.onComplete=f,c.fetch(d)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),d=new doh.Deferred;c.fetch({onComplete:k,onError:l});return d}},{name:"Read API: fetch() with MultiType Match",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,c){b.assertEqual(4,a.length),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("data_multitype")),d=new doh.Deferred;c.fetch({query:{count:"1*"},onComplete:e,onError:f});return d}},{name:"Read API: fetch() with RegExp Match",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,c){b.assertEqual(4,a.length),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("data_multitype")),d=new doh.Deferred;c.fetch({query:{count:new RegExp("^1.*$","gi")},onComplete:e,onError:f});return d}},{name:"Read API: fetch() with RegExp Match Inline",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,c){b.assertEqual(4,a.length),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("data_multitype")),d=new doh.Deferred;c.fetch({query:{count:/^1.*$/gi},onComplete:e,onError:f});return d}},{name:"Read API: fetch() with MultiType, MultiValue Match",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,c){b.assertEqual(7,a.length),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("data_multitype")),d=new doh.Deferred;c.fetch({query:{value:"true"},onComplete:e,onError:f});return d}},{name:"Read API: getLabel()",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,e){b.assertEqual(a.length,1);var f=c.getLabel(a[0]);b.assertTrue(f!==null),b.assertEqual("Ecuador",f),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),d=new doh.Deferred;c.fetch({query:{abbr:"ec"},onComplete:e,onError:f});return d}},{name:"Read API: getLabelAttributes()",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,e){b.assertEqual(a.length,1);var f=c.getLabelAttributes(a[0]);b.assertTrue(dojo.isArray(f)),b.assertEqual("name",f[0]),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),d=new doh.Deferred;c.fetch({query:{abbr:"ec"},onComplete:e,onError:f});return d}},{name:"Read API: getValue()",runTest:function(a,b){function f(a){b.assertTrue(!1),d.errback(a)}function e(a){b.assertTrue(a!==null);var e=c.getValue(a,"name");b.assertTrue(e==="El Salvador"),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),d=new doh.Deferred;c.fetchItemByIdentity({identity:"sv",onItem:e,onError:f});return d}},{name:"Read API: getValues()",runTest:function(a,b){function f(a){b.assertTrue(!1),d.errback(a)}function e(a){b.assertTrue(a!==null);var e=c.getValues(a,"name");b.assertTrue(dojo.isArray(e)),b.assertEqual(e.length,1),b.assertEqual(e[0],"El Salvador"),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),d=new doh.Deferred;c.fetchItemByIdentity({identity:"sv",onItem:e,onError:f});return d}},{name:"Read API: isItem()",runTest:function(a,b){function f(a){b.assertTrue(!1),d.errback(a)}function e(a){b.assertTrue(a!==null),b.assertTrue(c.isItem(a)),b.assertTrue(!c.isItem({})),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),d=new doh.Deferred;c.fetchItemByIdentity({identity:"sv",onItem:e,onError:f});return d}},{name:"Read API: isItem() multistore",runTest:function(a,b){function g(a){b.assertTrue(!1),e.errback(a)}function f(a){function f(f){b.assertTrue(a!==null),b.assertTrue(f!==null),b.assertTrue(c.isItem(a)),b.assertTrue(d.isItem(f)),b.assertTrue(!c.isItem(f)),b.assertTrue(!d.isItem(a)),e.callback(!0)}b.assertTrue(a!==null),d.fetchItemByIdentity({identity:"sv",onItem:f,onError:g})}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),d=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),e=new doh.Deferred;c.fetchItemByIdentity({identity:"sv",onItem:f,onError:g});return e}},{name:"Read API: hasAttribute()",runTest:function(a,b){function f(a){b.assertTrue(!1),d.errback(a)}function e(a){try{b.assertTrue(a!==null),b.assertTrue(c.hasAttribute(a,"abbr")),b.assertTrue(!c.hasAttribute(a,"abbr_not"));var e=!1;try{c.hasAttribute(a,null)}catch(f){e=!0}b.assertTrue(e),d.callback(!0)}catch(f){d.errback(f)}}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),d=new doh.Deferred;c.fetchItemByIdentity({identity:"sv",onItem:e,onError:f});return d}},{name:"Read API: containsValue()",runTest:function(a,b){function f(a){b.assertTrue(!1),d.errback(a)}function e(a){b.assertTrue(a!==null),b.assertTrue(c.containsValue(a,"abbr","sv")),b.assertTrue(!c.containsValue(a,"abbr","sv1")),b.assertTrue(!c.containsValue(a,"abbr",null));var e=!1;try{c.containsValue(a,null,"foo")}catch(f){e=!0}b.assertTrue(e),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),d=new doh.Deferred;c.fetchItemByIdentity({identity:"sv",onItem:e,onError:f});return d}},{name:"Read API: getAttributes()",runTest:function(a,b){function f(a){b.assertTrue(!1),d.errback(a)}function e(a){b.assertTrue(a!==null),b.assertTrue(c.isItem(a));var e=c.getAttributes(a);b.assertEqual(e.length,3);for(var f=0;f<e.length;f++)b.assertTrue(e[f]==="name"||e[f]==="abbr"||e[f]==="capital");d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),d=new doh.Deferred;c.fetchItemByIdentity({identity:"sv",onItem:e,onError:f});return d}},{name:"Read API: getFeatures()",runTest:function(a,b){var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),d=c.getFeatures();b.assertTrue(d["dojo.data.api.Read"]!=null),b.assertTrue(d["dojo.data.api.Identity"]!=null)}},{name:"Read API: fetch() patternMatch0",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,e){b.assertEqual(a.length,5);var f=!0;for(var g=0;g<a.length;g++){var h=c.getValue(a[g],"abbr");if(h!=="ec"&&h!=="eg"&&h!=="er"&&h!=="ee"&&h!=="et"){f=!1;break}}b.assertTrue(f),f?d.callback(!0):d.errback(new Error("Unexpected abbreviation found, match failure."))}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),d=new doh.Deferred;c.fetch({query:{abbr:"e*"},onComplete:e,onError:f});return d}},{name:"Read API: fetch() patternMatch1",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,e){b.assertEqual(a.length,2);var f=!0;for(var g=0;g<a.length;g++){var h=c.getValue(a[g],"value");if(h!=="bit$Bite"&&h!=="jfq4@#!$!@Rf14r14i5u"){f=!1;break}}b.assertTrue(f),f?d.callback(!0):d.errback(new Error("Unexpected pattern matched.  Filter failure."))}var c=new a({data:{identifier:"uniqueId",items:[{uniqueId:1,value:"foo*bar"},{uniqueId:2,value:"bar*foo"},{uniqueId:3,value:"boomBam"},{uniqueId:4,value:"bit$Bite"},{uniqueId:5,value:"ouagadogou"},{uniqueId:6,value:"BaBaMaSaRa***Foo"},{uniqueId:7,value:"squawl"},{uniqueId:8,value:"seaweed"},{uniqueId:9,value:"jfq4@#!$!@Rf14r14i5u"}]}}),d=new doh.Deferred;c.fetch({query:{value:"*$*"},onComplete:e,onError:f});return d}},{name:"Read API: fetch() patternMatch2",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,e){b.assertEqual(a.length,1);var f=!0;for(var g=0;g<a.length;g++){var h=c.getValue(a[g],"value");if(h!=="bar*foo"){f=!1;break}}b.assertTrue(f),f?d.callback(!0):d.errback(new Error("Unexpected abbreviation found, match failure."))}var c=new a({data:{identifier:"uniqueId",items:[{uniqueId:1,value:"foo*bar"},{uniqueId:2,value:"bar*foo"},{uniqueId:3,value:"boomBam"},{uniqueId:4,value:"bit$Bite"},{uniqueId:5,value:"ouagadogou"},{uniqueId:6,value:"BaBaMaSaRa***Foo"},{uniqueId:7,value:"squawl"},{uniqueId:8,value:"seaweed"},{uniqueId:9,value:"jfq4@#!$!@Rf14r14i5u"}]}}),d=new doh.Deferred;c.fetch({query:{value:"bar*foo"},onComplete:e,onError:f});return d}},{name:"Read API: fetch() patternMatch_caseSensitive",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,e){b.assertEqual(1,a.length);var f=!0;for(var g=0;g<a.length;g++){var h=c.getValue(a[g],"value");if(h!=="bar*foo"){f=!1;break}}b.assertTrue(f),f?d.callback(!0):d.errback(new Error("Unexpected pattern matched.  Filter failure."))}var c=new a({data:{identifier:"uniqueId",items:[{uniqueId:1,value:"foo*bar"},{uniqueId:2,value:"bar*foo"},{uniqueId:3,value:"BAR*foo"},{uniqueId:4,value:"BARBananafoo"}]}}),d=new doh.Deferred;c.fetch({query:{value:"bar\\*foo"},queryOptions:{ignoreCase:!1},onComplete:e,onError:f});return d}},{name:"Read API: fetch() patternMatch_caseInsensitive",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,e){b.assertEqual(a.length,2);var f=!0;for(var g=0;g<a.length;g++){var h=c.getValue(a[g],"value");if(h!=="BAR*foo"&&h!=="bar*foo"){f=!1;break}}b.assertTrue(f),f?d.callback(!0):d.errback(new Error("Unexpected pattern matched.  Filter failure."))}var c=new a({data:{identifier:"uniqueId",items:[{uniqueId:1,value:"foo*bar"},{uniqueId:2,value:"bar*foo"},{uniqueId:3,value:"BAR*foo"},{uniqueId:4,value:"BARBananafoo"}]}}),d=new doh.Deferred;c.fetch({query:{value:"bar\\*foo"},queryOptions:{ignoreCase:!0},onComplete:e,onError:f});return d}},{name:"Read API: fetch() sortNumeric",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,e){b.assertEqual(a.length,11);var f=!0;for(var g=0;g<a.length;g++){var h=c.getValue(a[g],"value");if(c.getValue(a[g],"uniqueId")!==g){f=!1;break}}b.assertTrue(f),f?d.callback(!0):d.errback(new Error("Unexpected sorting order found, sort failure."))}var c=new a({data:{identifier:"uniqueId",items:[{uniqueId:0,value:"fo|o*b.ar"},{uniqueId:1,value:"ba|r*foo"},{uniqueId:2,value:"boomBam"},{uniqueId:3,value:"bit$Bite"},{uniqueId:4,value:"ouagadogou"},{uniqueId:5,value:"jfq4@#!$!@|f1.$4r14i5u"},{uniqueId:6,value:"BaB{aMa|SaRa***F}oo"},{uniqueId:7,value:"squawl"},{uniqueId:9,value:"seaweed"},{uniqueId:10,value:"zulu"},{uniqueId:8,value:"seaweed"}]}}),d=new doh.Deferred,g=[{attribute:"uniqueId"}];c.fetch({onComplete:e,onError:f,sort:g});return d}},{name:"Read API: fetch() sortNumericDescending",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,e){b.assertEqual(a.length,11);var f=!0;for(var g=0;g<a.length;g++){var h=c.getValue(a[g],"value");if(a.length-(c.getValue(a[g],"uniqueId")+1)!==g){f=!1;break}}b.assertTrue(f),f?d.callback(!0):d.errback(new Error("Unexpected sorting order found, sort failure."))}var c=new a({data:{identifier:"uniqueId",items:[{uniqueId:0,value:"fo|o*b.ar"},{uniqueId:1,value:"ba|r*foo"},{uniqueId:2,value:"boomBam"},{uniqueId:3,value:"bit$Bite"},{uniqueId:4,value:"ouagadogou"},{uniqueId:5,value:"jfq4@#!$!@|f1.$4r14i5u"},{uniqueId:6,value:"BaB{aMa|SaRa***F}oo"},{uniqueId:7,value:"squawl"},{uniqueId:9,value:"seaweed"},{uniqueId:10,value:"zulu"},{uniqueId:8,value:"seaweed"}]}}),d=new doh.Deferred,g=[{attribute:"uniqueId",descending:!0}];c.fetch({onComplete:e,onError:f,sort:g});return d}},{name:"Read API: fetch() sortNumericWithCount",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,e){b.assertEqual(a.length,5);var f=10,g=!0;for(var h=0;h<a.length;h++){var i=c.getValue(a[h],"value");if(c.getValue(a[h],"uniqueId")!==f){g=!1;break}f--}b.assertTrue(g),g?d.callback(!0):d.errback(new Error("Unexpected sorting order found, sort failure."))}var c=new a({data:{identifier:"uniqueId",items:[{uniqueId:0,value:"fo|o*b.ar"},{uniqueId:1,value:"ba|r*foo"},{uniqueId:2,value:"boomBam"},{uniqueId:3,value:"bit$Bite"},{uniqueId:4,value:"ouagadogou"},{uniqueId:5,value:"jfq4@#!$!@|f1.$4r14i5u"},{uniqueId:6,value:"BaB{aMa|SaRa***F}oo"},{uniqueId:7,value:"squawl"},{uniqueId:9,value:"seaweed"},{uniqueId:10,value:"zulu"},{uniqueId:8,value:"seaweed"}]}}),d=new doh.Deferred,g=[{attribute:"uniqueId",descending:!0}];c.fetch({onComplete:e,onError:f,sort:g,count:5});return d}},{name:"Read API: fetch() sortAlphabetic",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,e){var f=["","123abc","abc","abcd","abcdefg","bca","foghorn","lmnop","qberty","qwerty","seaweed"];b.assertEqual(a.length,11);var g=!0;for(var h=0;h<a.length;h++){var i=c.getValue(a[h],"value");if(c.getValue(a[h],"value")!==f[h]){g=!1;break}}b.assertTrue(g),g?d.callback(!0):d.errback(new Error("Unexpected sorting order found, sort failure."))}var c=new a({data:{identifier:"uniqueId",items:[{uniqueId:0,value:"abc"},{uniqueId:1,value:"bca"},{uniqueId:2,value:"abcd"},{uniqueId:3,value:"abcdefg"},{uniqueId:4,value:"lmnop"},{uniqueId:5,value:"foghorn"},{uniqueId:6,value:"qberty"},{uniqueId:7,value:"qwerty"},{uniqueId:8,value:""},{uniqueId:9,value:"seaweed"},{uniqueId:10,value:"123abc"}]}}),d=new doh.Deferred,g=[{attribute:"value"}];c.fetch({onComplete:e,onError:f,sort:g});return d}},{name:"Read API: fetch() sortAlphabeticDescending",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,e){var f=["","123abc","abc","abcd","abcdefg","bca","foghorn","lmnop","qberty","qwerty","seaweed"];f=f.reverse(),b.assertEqual(a.length,11);var g=!0;for(var h=0;h<a.length;h++){var i=c.getValue(a[h],"value");if(c.getValue(a[h],"value")!==f[h]){g=!1;break}}b.assertTrue(g),g?d.callback(!0):d.errback(new Error("Unexpected sorting order found, sort failure."))}var c=new a({data:{identifier:"uniqueId",items:[{uniqueId:0,value:"abc"},{uniqueId:1,value:"bca"},{uniqueId:2,value:"abcd"},{uniqueId:3,value:"abcdefg"},{uniqueId:4,value:"lmnop"},{uniqueId:5,value:"foghorn"},{uniqueId:6,value:"qberty"},{uniqueId:7,value:"qwerty"},{uniqueId:8,value:""},{uniqueId:9,value:"seaweed"},{uniqueId:10,value:"123abc"}]}}),d=new doh.Deferred,g=[{attribute:"value",descending:!0}];c.fetch({onComplete:e,onError:f,sort:g});return d}},{name:"Read API: fetch() sortDate",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,e){var f=[0,100,1e3,2e3,3e3,4e3,5e3,6e3,7e3,8e3,9e3];b.assertEqual(a.length,11);var g=!0;for(var h=0;h<a.length;h++){var i=c.getValue(a[h],"value");if(c.getValue(a[h],"value").getTime()!==f[h]){g=!1;break}}b.assertTrue(g),g?d.callback(!0):d.errback(new Error("Unexpected sorting order found, sort failure."))}var c=new a({data:{identifier:"uniqueId",items:[{uniqueId:0,value:new Date(0)},{uniqueId:1,value:new Date(100)},{uniqueId:2,value:new Date(1e3)},{uniqueId:3,value:new Date(2e3)},{uniqueId:4,value:new Date(3e3)},{uniqueId:5,value:new Date(4e3)},{uniqueId:6,value:new Date(5e3)},{uniqueId:7,value:new Date(6e3)},{uniqueId:8,value:new Date(7e3)},{uniqueId:9,value:new Date(8e3)},{uniqueId:10,value:new Date(9e3)}]}}),d=new doh.Deferred,g=[{attribute:"value"}];c.fetch({onComplete:e,onError:f,sort:g});return d}},{name:"Read API: fetch() sortDateDescending",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,e){var f=[0,100,1e3,2e3,3e3,4e3,5e3,6e3,7e3,8e3,9e3];f=f.reverse(),b.assertEqual(a.length,11);var g=!0;for(var h=0;h<a.length;h++){var i=c.getValue(a[h],"value");if(c.getValue(a[h],"value").getTime()!==f[h]){g=!1;break}}b.assertTrue(g),g?d.callback(!0):d.errback(new Error("Unexpected sorting order found, sort failure."))}var c=new a({data:{identifier:"uniqueId",items:[{uniqueId:0,value:new Date(0)},{uniqueId:1,value:new Date(100)},{uniqueId:2,value:new Date(1e3)},{uniqueId:3,value:new Date(2e3)},{uniqueId:4,value:new Date(3e3)},{uniqueId:5,value:new Date(4e3)},{uniqueId:6,value:new Date(5e3)},{uniqueId:7,value:new Date(6e3)},{uniqueId:8,value:new Date(7e3)},{uniqueId:9,value:new Date(8e3)},{uniqueId:10,value:new Date(9e3)}]}}),d=new doh.Deferred,g=[{attribute:"value",descending:!0}];c.fetch({onComplete:e,onError:f,sort:g});return d}},{name:"Read API: fetch() sortMultiple",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,e){var f=[7,2,4,3,1,6,5,12,10,9,8,11],g=["BaB{aMa|SaRa***F}oo","ba|r*foo","bit$Bite","boomBam","fo|o*b.ar","jfq4@#!$!@|f1.$4r14i5u","ouagadogou","seaweed","seaweed","seaweed","squawl","zulu"],h=!0;for(var i=0;i<a.length;i++){var j=c.getValue(a[i],"value");if(c.getValue(a[i],"uniqueId")!==f[i]||c.getValue(a[i],"value")!==g[i]){h=!1;break}}b.assertTrue(h),h?d.callback(!0):d.errback(new Error("Unexpected sorting order found, sort failure."))}var c=new a({data:{identifier:"uniqueId",items:[{uniqueId:1,value:"fo|o*b.ar"},{uniqueId:2,value:"ba|r*foo"},{uniqueId:3,value:"boomBam"},{uniqueId:4,value:"bit$Bite"},{uniqueId:5,value:"ouagadogou"},{uniqueId:6,value:"jfq4@#!$!@|f1.$4r14i5u"},{uniqueId:7,value:"BaB{aMa|SaRa***F}oo"},{uniqueId:8,value:"squawl"},{uniqueId:10,value:"seaweed"},{uniqueId:12,value:"seaweed"},{uniqueId:11,value:"zulu"},{uniqueId:9,value:"seaweed"}]}}),d=new doh.Deferred,g=[{attribute:"value"},{attribute:"uniqueId",descending:!0}];c.fetch({onComplete:e,onError:f,sort:g});return d}},{name:"Read API: fetch() sortMultipleSpecialComparator",runTest:function(a,b){function g(a,c){b.assertTrue(!1),e.errback(a)}function f(a,d){var f=[11,6,2,12,10,4,8,7,3,9,5,1],g=!0;for(var h=0;h<a.length;h++){var i=c.getValue(a[h],"value");if(c.getValue(a[h],"uniqueId")!==f[h]){g=!1;break}}b.assertTrue(g),g?e.callback(!0):e.errback(new Error("Unexpected sorting order found, sort failure."))}var c=new a({data:{identifier:"uniqueId",items:[{uniqueId:1,status:"CLOSED"},{uniqueId:2,status:"OPEN"},{uniqueId:3,status:"PENDING"},{uniqueId:4,status:"BLOCKED"},{uniqueId:5,status:"CLOSED"},{uniqueId:6,status:"OPEN"},{uniqueId:7,status:"PENDING"},{uniqueId:8,status:"PENDING"},{uniqueId:10,status:"BLOCKED"},{uniqueId:12,status:"BLOCKED"},{uniqueId:11,status:"OPEN"},{uniqueId:9,status:"CLOSED"}]}});c.comparatorMap={},c.comparatorMap.status=function(a,b){var c=0,d={OPEN:3,BLOCKED:2,PENDING:1,CLOSED:0};d[a]>d[b]&&(c=1),d[a]<d[b]&&(c=-1);return c};var d=[{attribute:"status",descending:!0},{attribute:"uniqueId",descending:!0}],e=new doh.Deferred;c.fetch({onComplete:f,onError:g,sort:d});return e}},{name:"Read API: fetch() sortAlphabeticWithUndefined",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}function e(a,e){var f=[10,0,2,3,1,5,4,6,7,9,8];b.assertEqual(a.length,11);var g=!0;for(var h=0;h<a.length;h++)if(c.getValue(a[h],"uniqueId")!==f[h]){g=!1;break}b.assertTrue(g),g?d.callback(!0):d.errback(new Error("Unexpected sorting order found, sort failure."))}var c=new a({data:{identifier:"uniqueId",items:[{uniqueId:0,value:"abc"},{uniqueId:1,value:"bca"},{uniqueId:2,value:"abcd"},{uniqueId:3,value:"abcdefg"},{uniqueId:4,value:"lmnop"},{uniqueId:5,value:"foghorn"},{uniqueId:6,value:"qberty"},{uniqueId:7,value:"qwerty"},{uniqueId:8},{uniqueId:9,value:"seaweed"},{uniqueId:10,value:"123abc"}]}}),d=new doh.Deferred,g=[{attribute:"value"}];c.fetch({onComplete:e,onError:f,sort:g});return d}},{name:"Read API: errorCondition_idCollision_inMemory",runTest:function(a,b){function f(a,c){b.assertTrue(!0),d.callback(!0)}function e(a,c){b.assertTrue(!1),d.callback(!1)}var c=new a({data:{identifier:"uniqueId",items:[{uniqueId:12345,value:"foo"},{uniqueId:123456,value:"bar"},{uniqueId:12345,value:"boom"},{uniqueId:123457,value:"bit"}]}}),d=new doh.Deferred;c.fetch({onComplete:e,onError:f});return d}},{name:"Read API: errorCondition_idCollision_xhr",runTest:function(a,b){if(dojo.isBrowser){var c=new a({url:dojo.moduleUrl("tests","data/countries_idcollision.json").toString()}),d=new doh.Deferred;function e(a,c){b.assertTrue(!1),d.callback(!1)}function f(a,c){b.assertTrue(!0),d.callback(!0)}c.fetch({onComplete:e,onError:f});return d}}},{name:"Read API: Date_datatype",runTest:function(a,b){function f(a){b.assertTrue(!1),d.errback(a)}function e(a){b.assertTrue(a!==null);var e=c.getValue(a,"independence");b.assertTrue(e instanceof Date),b.assertTrue(dojo.date.stamp.toISOString(e,{zulu:!0})==="1993-05-24T00:00:00Z"),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries_withDates")),d=new doh.Deferred;c.fetchItemByIdentity({identity:"er",onItem:e,onError:f});return d}},{name:"Read API: custom_datatype_Color_SimpleMapping",runTest:function(a,b){function g(a){e.errback(a)}function f(a){b.assertTrue(a!==null);var c=a,f=d.getValue(c,"hairColor");b.assertTrue(f instanceof dojo.Color),b.assertTrue(f.toHex()=="#ff0000"),e.callback(!0)}var c={identifier:"name",items:[{name:"Kermit",species:"frog",color:{_type:"Color",_value:"green"}},{name:"Beaker",hairColor:{_type:"Color",_value:"red"}}]},d=new a({data:c,typeMap:{Color:dojo.Color}}),e=new doh.Deferred;d.fetchItemByIdentity({identity:"Beaker",onItem:f,onError:g});return e}},{name:"Read API: custom_datatype_Color_GeneralMapping",runTest:function(a,b){function g(a){e.errback(a)}function f(a){b.assertTrue(a!==null);var c=a,f=d.getValue(c,"hairColor");b.assertTrue(f instanceof dojo.Color),b.assertTrue(f.toHex()=="#ff0000"),e.callback(!0)}var c={identifier:"name",items:[{name:"Kermit",species:"frog",color:{_type:"Color",_value:"green"}},{name:"Beaker",hairColor:{_type:"Color",_value:"red"}}]},d=new a({data:c,typeMap:{Color:{type:dojo.Color,deserialize:function(a){return new dojo.Color(a)}}}}),e=new doh.Deferred;d.fetchItemByIdentity({identity:"Beaker",onItem:f,onError:g});return e}},{name:"Read API: custom_datatype_CustomObject 0 (False) value",runTest:function(a,b){function g(a){e.errback(a)}function f(a){b.assertTrue(a!==null);var c=a,f=d.getValue(a,"age");b.assertTrue(f instanceof tests.data.Wrapper),b.assertTrue(f.toString()=="WRAPPER: [0]"),e.callback(!0)}var c={identifier:"name",items:[{name:"Bob",species:"human",age:{_type:"tests.data.Wrapper",_value:0}},{name:"Nancy",species:"human",age:{_type:"tests.data.Wrapper",_value:32}}]},d=new a({data:c,typeMap:{"tests.data.Wrapper":{type:tests.data.Wrapper,deserialize:function(a){return new tests.data.Wrapper(a)}}}}),e=new doh.Deferred;d.fetchItemByIdentity({identity:"Bob",onItem:f,onError:g});return e}},{name:"Read API: custom_datatype_CustomObject Boolean False values",runTest:function(a,b){function g(a){e.errback(a)}function f(a){b.assertTrue(a!==null);var c=a,f=d.getValue(a,"isHuman");b.assertTrue(f instanceof tests.data.Wrapper),b.assertTrue(f.toString()=="WRAPPER: [false]"),e.callback(!0)}var c={identifier:"name",items:[{name:"Bob",isHuman:{_type:"tests.data.Wrapper",_value:!1}},{name:"Nancy",isHuman:{_type:"tests.data.Wrapper",_value:!0}}]},d=new a({data:c,typeMap:{"tests.data.Wrapper":{type:tests.data.Wrapper,deserialize:function(a){return new tests.data.Wrapper(a)}}}}),e=new doh.Deferred;d.fetchItemByIdentity({identity:"Bob",onItem:f,onError:g});return e}},{name:"Read API: custom_datatype_CustomObject Empty String values",runTest:function(a,b){function g(a){e.errback(a)}function f(a){b.assertTrue(a!==null);var c=a,f=d.getValue(a,"lastName");b.assertTrue(f instanceof tests.data.Wrapper),b.assertTrue(f.toString()=="WRAPPER: []"),e.callback(!0)}var c={identifier:"name",items:[{name:"Bob",lastName:{_type:"tests.data.Wrapper",_value:""}},{name:"Nancy",lastName:{_type:"tests.data.Wrapper",_value:"Doe"}}]},d=new a({data:c,typeMap:{"tests.data.Wrapper":{type:tests.data.Wrapper,deserialize:function(a){return new tests.data.Wrapper(a)}}}}),e=new doh.Deferred;d.fetchItemByIdentity({identity:"Bob",onItem:f,onError:g});return e}},{name:"Read API: custom_datatype_CustomObject explicit null values",runTest:function(a,b){function g(a){e.errback(a)}function f(a){b.assertTrue(a!==null);var c=a,f=d.getValue(a,"lastName");b.assertTrue(f instanceof tests.data.Wrapper),b.assertTrue(f.toString()=="WRAPPER: [null]"),e.callback(!0)}var c={identifier:"name",items:[{name:"Bob",lastName:{_type:"tests.data.Wrapper",_value:null}},{name:"Nancy",lastName:{_type:"tests.data.Wrapper",_value:"Doe"}}]},d=new a({data:c,typeMap:{"tests.data.Wrapper":{type:tests.data.Wrapper,deserialize:function(a){return new tests.data.Wrapper(a)}}}}),e=new doh.Deferred;d.fetchItemByIdentity({identity:"Bob",onItem:f,onError:g});return e}},{name:"Read API: custom_datatype_CustomObject explicit undefined value",runTest:function(a,b){function g(a){e.errback(a)}function f(a){b.assertTrue(a!==null);var c=a,f=d.getValue(a,"lastName");b.assertTrue(f instanceof tests.data.Wrapper),b.assertTrue(f.toString()=="WRAPPER: [undefined]"),e.callback(!0)}var c={identifier:"name",items:[{name:"Bob",lastName:{_type:"tests.data.Wrapper",_value:undefined}},{name:"Nancy",lastName:{_type:"tests.data.Wrapper",_value:"Doe"}}]},d=new a({data:c,typeMap:{"tests.data.Wrapper":{type:tests.data.Wrapper,deserialize:function(a){return new tests.data.Wrapper(a)}}}}),e=new doh.Deferred;d.fetchItemByIdentity({identity:"Bob",onItem:f,onError:g});return e}},{name:"Read API: hierarchical_data",runTest:function(a,b){function f(a){d.errback(a)}function e(a,e){b.assertEqual(a.length,1);var f=a[0],g=c.getValue(f,"countries"),h=c.getValue(g,"cities");b.assertEqual(c.getValue(g,"name"),"Canada"),b.assertEqual(c.getValue(h,"name"),"Toronto"),d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("geography_hierarchy_small")),d=new doh.Deferred;c.fetch({query:{name:"North America"},onComplete:e,onError:f});return d}},{name:"Read API: close (clearOnClose: true)",runTest:function(a,b){if(dojo.isBrowser){var c=tests.data.readOnlyItemFileTestTemplates.getTestData("countries");c.clearOnClose=!0,c.urlPreventCache=!0;var d=new a(c),e=new doh.Deferred;function f(a){var c=null;try{b.assertTrue(a!==null);var f=a,g=d.getValue(f,"name");b.assertEqual("Ecuador",g),d.close(),b.assertTrue(d._arrayOfAllItems.length===0),b.assertTrue(d._loadFinished===!1)}catch(h){c=h}c?e.errback(c):e.callback(!0)}function g(a){e.errback(a)}d.fetchItemByIdentity({identity:"ec",onItem:f,onError:g});return e}}},{name:"Read API: close (clearOnClose: true, reset url.)",runTest:function(a,b){if(dojo.isBrowser){var c=tests.data.readOnlyItemFileTestTemplates.getTestData("countries");c.clearOnClose=!0,c.urlPreventCache=!0;var d=new a(c),e=new doh.Deferred;function f(a){var c=null;try{b.assertTrue(a!==null);var f=a,h=d.getValue(f,"name");b.assertEqual("Ecuador",h),d.close(),b.assertTrue(d._arrayOfAllItems.length===0),b.assertTrue(d._loadFinished===!1),d.url=dojo.moduleUrl("tests","data/countries_withNull.json").toString();function i(a){var c;try{b.assertTrue(a!==null);var f=d.getValue(a,"name");b.assertEqual(null,f)}catch(g){c=g}c?e.errback(c):e.callback(!0)}d.fetchItemByIdentity({identity:"ec",onItem:i,onError:g})}catch(j){c=j}c&&e.errback(c)}function g(a){e.errback(a)}d.fetchItemByIdentity({identity:"ec",onItem:f,onError:g});return e}}},{name:"Read API: fetch, close (clearOnClose: true, reset url.)",runTest:function(a,b){if(dojo.isBrowser){var c=tests.data.readOnlyItemFileTestTemplates.getTestData("countries");c.clearOnClose=!0,c.urlPreventCache=!0;var d=new a(c),e=new doh.Deferred;function f(a){var c=null;try{b.assertTrue(a!==null);var f=a,h=d.getValue(f,"name");b.assertEqual("Ecuador",h),d.close(),b.assertTrue(d._arrayOfAllItems.length===0),b.assertTrue(d._loadFinished===!1),d.url=dojo.moduleUrl("tests","data/countries_withNull.json").toString();function i(a){var c;try{b.assertEqual(1,a.length);var f=a[0];b.assertTrue(f!==null);var g=d.getValue(f,"name");b.assertEqual(null,g)}catch(h){c=h}c?e.errback(c):e.callback(!0)}d.fetch({query:{abbr:"ec"},onComplete:i,onError:g})}catch(j){c=j}c&&e.errback(c)}function g(a){e.errback(a)}d.fetchItemByIdentity({identity:"ec",onItem:f,onError:g});return e}}},{name:"Read API: close (clearOnClose: true, reset _jsonFileUrl.)",runTest:function(a,b){if(dojo.isBrowser){var c=tests.data.readOnlyItemFileTestTemplates.getTestData("countries");c.clearOnClose=!0,c.urlPreventCache=!0;var d=new a(c),e=new doh.Deferred;function f(a){var c=null;try{b.assertTrue(a!==null);var f=a,h=d.getValue(f,"name");b.assertEqual("Ecuador",h),d.close(),b.assertTrue(d._arrayOfAllItems.length===0),b.assertTrue(d._loadFinished===!1),d._jsonFileUrl=dojo.moduleUrl("tests","data/countries_withNull.json").toString();function i(a){var c;try{b.assertTrue(a!==null);var f=d.getValue(a,"name");b.assertEqual(null,f)}catch(g){c=g}c?e.errback(c):e.callback(!0)}d.fetchItemByIdentity({identity:"ec",onItem:i,onError:g})}catch(j){c=j}c&&e.errback(c)}function g(a){e.errback(a)}d.fetchItemByIdentity({identity:"ec",onItem:f,onError:g});return e}}},{name:"Read API: close (clearOnClose: false)",runTest:function(a,b){if(dojo.isBrowser){var c=tests.data.readOnlyItemFileTestTemplates.getTestData("countries");c.urlPreventCache=!0;var d=new a(c),e=new doh.Deferred;function f(a){var c=null;try{b.assertTrue(a!==null);var f=a,g=d.getValue(f,"name");b.assertEqual("Ecuador",g),d.close(),b.assertTrue(d._arrayOfAllItems.length!==0),b.assertTrue(d._loadFinished===!0)}catch(h){c=h}c?e.errback(c):e.callback(!0)}function g(a){e.errback(a)}d.fetchItemByIdentity({identity:"ec",onItem:f,onError:g});return e}}},{name:"Read API: close (clearOnClose: true, reset data.)",runTest:function(a,b){function f(a,c){b.assertTrue(!1),d.errback(a)}var c=new a({data:{identifier:"uniqueId",items:[{uniqueId:1,value:"foo*bar"},{uniqueId:2,value:"bar*foo"},{uniqueId:3,value:"boomBam"},{uniqueId:4,value:"bit$Bite"},{uniqueId:5,value:"ouagadogou"},{uniqueId:6,value:"BaBaMaSaRa***Foo"},{uniqueId:7,value:"squawl"},{uniqueId:8,value:"seaweed"},{uniqueId:9,value:"jfq4@#!$!@Rf14r14i5u"}]}}),d=new doh.Deferred,e=function(a,e){b.assertEqual(a.length,1);var g=a[0];c.clearOnClose=!0,c.data={identifier:"uniqueId",items:[{uniqueId:1,value:"foo*bar"},{uniqueId:2,value:"bar*foo"},{uniqueId:3,value:"boomBam"},{uniqueId:4,value:"bit$Bite"},{uniqueId:5,value:"ouagadogou"},{uniqueId:6,value:"BaBaMaSaRa***Foo"},{uniqueId:7,value:"squawl"},{uniqueId:8,value:"seaweed"},{uniqueId:9,value:"jfq4@#!$!@Rf14r14i5u"}]},c.close();var h=function(a,c){try{b.assertEqual(a.length,1);var e=a[0];b.assertTrue(g!=null),b.assertTrue(e!=null),b.assertTrue(g!=e),d.callback(!0)}catch(f){d.errback(f)}};c.fetch({query:{value:"bar*foo"},onComplete:h,onError:f})};c.fetch({query:{value:"bar*foo"},onComplete:e,onError:f});return d}},{name:"Identity API: no_identifier_specified",runTest:function(a,b){function g(a,b){e.errback(!0)}function f(a,c){var f=d.getFeatures(),g=Boolean(f["dojo.data.api.Identity"]);b.assertTrue(g);for(var h=0;h<a.length;++h){var i=a[h],j=d.getIdentityAttributes(i);b.assertTrue(j===null);var k=d.getIdentity(i);b.assertTrue(typeof k=="number")}e.callback(!0)}var c=[{name:"Kermit",color:"green"},{name:"Miss Piggy",likes:"Kermit"},{name:"Beaker",hairColor:"red"}],d=new a({data:{items:c}}),e=new doh.Deferred;d.fetch({onComplete:f,onError:g});return e}},{name:"Identity API: hierarchical_data",runTest:function(a,b){function f(a,b){d.errback(!0)}function e(a,e){var f=c.getFeatures(),g=Boolean(f["dojo.data.api.Identity"]);b.assertTrue(g);for(var h=0;h<a.length;++h){var i=a[h],j=c.getIdentityAttributes(i);b.assertTrue(j===null);var k=c.getIdentity(i);b.assertTrue(typeof k=="number")}d.callback(!0)}var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("geography_hierarchy_small")),d=new doh.Deferred;c.fetch({onComplete:e,onError:f});return d}},{name:"Read API: functionConformance",runTest:function(a,b){var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),d=new dojo.data.api.Read,e=!0;for(i in d)if(i.toString().charAt(0)!=="_"){var f=d[i];if(typeof f==="function"){var g=c[i];if(typeof g!=="function"){e=!1;break}}}b.assertTrue(e)}},{name:"Identity API: functionConformance",runTest:function(a,b){var c=new a(tests.data.readOnlyItemFileTestTemplates.getTestData("countries")),d=new dojo.data.api.Identity,e=!0;for(i in d)if(i.toString().charAt(0)!=="_"){var f=d[i];if(typeof f==="function"){var g=c[i];if(typeof g!=="function"){e=!1;break}}}b.assertTrue(e)}}]})