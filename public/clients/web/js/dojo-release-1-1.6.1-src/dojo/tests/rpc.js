dojo.provide("tests.rpc"),dojo.require("dojo.rpc.RpcService"),dojo.require("dojo.rpc.JsonService"),dojo.require("dojo.rpc.JsonpService"),doh.register("tests.rpc",[{name:"JsonRPC-EchoTest",timeout:2e3,setUp:function(){var a={serviceURL:"../../dojo/tests/resources/test_JsonRPCMediator.php",methods:[{name:"myecho",parameters:[{name:"somestring",type:"STRING"}]}]};this.svc=new dojo.rpc.JsonService(a)},runTest:function(){var a=new doh.Deferred,b=this.svc.myecho("RPC TEST");if(window.location.protocol=="file:"){var c=new Error("This Test requires a webserver and PHP and will fail intentionally if loaded from file://");a.errback(c);return a}b.addCallbacks(function(a){return a=="<P>RPC TEST</P>"?!0:new Error("JsonRpc-EchoTest test failed, resultant content didn't match")},function(a){return new Error(a)}),b.addBoth(a,"callback");return a}},{name:"JsonRPC-EmptyParamTest",timeout:2e3,setUp:function(){var a={serviceURL:"../../dojo/tests/resources/test_JsonRPCMediator.php",methods:[{name:"contentB"}]};this.svc=new dojo.rpc.JsonService(a)},runTest:function(){var a=new doh.Deferred,b=this.svc.contentB();if(window.location.protocol=="file:"){var c=new Error("This Test requires a webserver and PHP and will fail intentionally if loaded from file://");a.errback(c);return a}b.addCallbacks(function(a){return a=="<P>Content B</P>"?!0:new Error("JsonRpc-EmpytParamTest test failed, resultant content didn't match")},function(a){return new Error(a)}),b.addBoth(a,"callback");return a}},{name:"JsonRPC_SMD_Loading_test",setUp:function(){this.svc=new dojo.rpc.JsonService("../../dojo/tests/resources/testClass.smd")},runTest:function(){return this.svc.objectName=="testClass"?!0:new Error("Error loading and/or parsing an smd file")}},{name:"JsonP_test",timeout:1e4,setUp:function(){this.svc=new dojo.rpc.JsonpService(dojo.moduleUrl("dojo.tests.resources","yahoo_smd_v1.smd"),{appid:"foo"})},runTest:function(){var a=new doh.Deferred;if(window.location.protocol=="file:"){var b=new Error("This Test requires a webserver and will fail intentionally if loaded from file://");a.errback(b);return a}var c=this.svc.webSearch({query:"dojotoolkit"});c.addCallbacks(function(a){return!0},function(a){return new Error(a)}),c.addBoth(a,"callback");return a}}])