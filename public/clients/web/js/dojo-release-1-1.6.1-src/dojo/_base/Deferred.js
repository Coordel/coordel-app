define("dojo/_base/Deferred",["dojo/lib/kernel","dojo/_base/lang"],function(a){(function(){var b=function(){},c=Object.freeze||function(){};a.Deferred=function(d){function l(){var c;while(!c&&i){var d=i;i=i.next;if(c=d.progress==b)f=!1;var h=g?d.error:d.resolved;if(h)try{var j=h(e);if(j&&typeof j.then==="function"){j.then(a.hitch(d.deferred,"resolve"),a.hitch(d.deferred,"reject"));continue}var k=c&&j===undefined;c&&!k&&(g=j instanceof Error),d.deferred[k&&g?"reject":"resolve"](k?e:j)}catch(l){d.deferred.reject(l)}else g?d.deferred.reject(e):d.deferred.resolve(e)}}function k(a){if(f)throw new Error("This deferred has already been resolved");e=a,f=!0,l()}var e,f,g,h,i,j=this.promise={};this.resolve=this.callback=function(a){this.fired=0,this.results=[a,null],k(a)},this.reject=this.errback=function(b){g=!0,this.fired=1,k(b),this.results=[null,b],(!b||b.log!==!1)&&(a.config.deferredOnError||function(a){console.error(a)})(b)},this.progress=function(a){var b=i;while(b){var c=b.progress;c&&c(a),b=b.next}},this.addCallbacks=function(a,c){this.then(a,c,b);return this},this.then=j.then=function(c,d,e){var g=e==b?this:new a.Deferred(j.cancel),k={resolved:c,error:d,progress:e,deferred:g};i?h=h.next=k:i=h=k,f&&l();return g.promise};var m=this;this.cancel=j.cancel=function(){if(!f){var a=d&&d(m);f||(a instanceof Error||(a=new Error(a)),a.log=!1,m.reject(a))}},c(j)},a.extend(a.Deferred,{addCallback:function(b){return this.addCallbacks(a.hitch.apply(a,arguments))},addErrback:function(b){return this.addCallbacks(null,a.hitch.apply(a,arguments))},addBoth:function(b){var c=a.hitch.apply(a,arguments);return this.addCallbacks(c,c)},fired:-1})})(),a.when=function(a,b,c,d){if(a&&typeof a.then==="function")return a.then(b,c,d);return b(a)};return a.Deferred})