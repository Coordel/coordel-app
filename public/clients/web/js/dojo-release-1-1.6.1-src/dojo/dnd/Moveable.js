define("dojo/dnd/Moveable",["dojo","dojo/dnd/Mover"],function(a){a.declare("dojo.dnd.Moveable",null,{handle:"",delay:0,skip:!1,constructor:function(b,c){this.node=a.byId(b),c||(c={}),this.handle=c.handle?a.byId(c.handle):null,this.handle||(this.handle=this.node),this.delay=c.delay>0?c.delay:0,this.skip=c.skip,this.mover=c.mover?c.mover:a.dnd.Mover,this.events=[a.connect(this.handle,"onmousedown",this,"onMouseDown"),a.connect(this.handle,"ontouchstart",this,"onMouseDown"),a.connect(this.handle,"ondragstart",this,"onSelectStart"),a.connect(this.handle,"onselectstart",this,"onSelectStart")]},markupFactory:function(b,c){return new a.dnd.Moveable(c,b)},destroy:function(){a.forEach(this.events,a.disconnect),this.events=this.node=this.handle=null},onMouseDown:function(b){if(!this.skip||!a.dnd.isFormElement(b)){if(this.delay){this.events.push(a.connect(this.handle,"onmousemove",this,"onMouseMove"),a.connect(this.handle,"ontouchmove",this,"onMouseMove"),a.connect(this.handle,"onmouseup",this,"onMouseUp"),a.connect(this.handle,"ontouchend",this,"onMouseUp"));var c=b.touches?b.touches[0]:b;this._lastX=c.pageX,this._lastY=c.pageY}else this.onDragDetected(b);a.stopEvent(b)}},onMouseMove:function(b){var c=b.touches?b.touches[0]:b;if(Math.abs(c.pageX-this._lastX)>this.delay||Math.abs(c.pageY-this._lastY)>this.delay)this.onMouseUp(b),this.onDragDetected(b);a.stopEvent(b)},onMouseUp:function(b){for(var c=0;c<2;++c)a.disconnect(this.events.pop());a.stopEvent(b)},onSelectStart:function(b){(!this.skip||!a.dnd.isFormElement(b))&&a.stopEvent(b)},onDragDetected:function(a){new this.mover(this.node,a,this)},onMoveStart:function(b){a.publish("/dnd/move/start",[b]),a.addClass(a.body(),"dojoMove"),a.addClass(this.node,"dojoMoveItem")},onMoveStop:function(b){a.publish("/dnd/move/stop",[b]),a.removeClass(a.body(),"dojoMove"),a.removeClass(this.node,"dojoMoveItem")},onFirstMove:function(a,b){},onMove:function(a,b,c){this.onMoving(a,b);var d=a.node.style;d.left=b.l+"px",d.top=b.t+"px",this.onMoved(a,b)},onMoving:function(a,b){},onMoved:function(a,b){}});return a.dnd.Moveable})