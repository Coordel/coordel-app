var fileUtil={};fileUtil.getLineSeparator=function(){return java.lang.System.getProperty("line.separator")},fileUtil.getFilteredFileList=function(a,b,c,d,e){var f=[],g=a;d||(g=new java.io.File(a));var h=b.include||b,i=b.exclude||null;if(g.exists()){var j=g.listFiles();for(var k=0;k<j.length;k++){var l=j[k];if(l.isFile()){var m=l.getPath();c&&(m=new String(m),m.indexOf("/")==-1&&(m=m.replace(/\\/g,"/")));var n=!0;h&&(n=m.match(h)),n&&i&&(n=!m.match(i)),n&&!l.getName().match(/^\./)&&f.push(m)}else if(l.isDirectory()&&!l.getName().match(/^\./)&&!e){var o=this.getFilteredFileList(l,b,c,!0);f.push.apply(f,o)}}}return f},fileUtil.copyDir=function(a,b,c,d){var e=fileUtil.getFilteredFileList(a,c,!0),f=[];for(var g=0;g<e.length;g++){var h=e[g],i=h.replace(a,b);fileUtil.copyFile(h,i,d)&&f.push(i)}return f.length?f:null},fileUtil.asyncFixEOLRe=new RegExp(fileUtil.getLineSeparator(),"g"),fileUtil.transformAsyncModule=function(filename,contents){var match,bundleMatch,moduleId,requireArgs=[],lineSeparator=fileUtil.getLineSeparator(),dojo={isBrowser:!0},getAsyncArgs=function(a,b){b?moduleId=a:b=a;for(var c=0;c<b.length;c++)b[c]!="require"&&requireArgs.push(b[c].replace(/\//g,"."))};match=contents.match(/(\/\/begin\sv1\.x\scontent)([\s\S]+)(\/\/end\sv1\.x\scontent)/);if(match)return match[2];match=contents.match(/\/\/\s*AMD\-ID\s*"([^\n"]+)"/i),moduleId=match&&match[1]||"";if(moduleId||contents.substring(0,8)=='define("'){if(match=contents.match(/^define\(([^\]]+)\]\s*\,[\s\n]*function.+$/m)){eval("getAsyncArgs("+match[1]+"])");if(!moduleId){logger.info("warning: the module "+filename+" looked like an AMD module, but didn't provide a module id");return contents}var prefix='dojo.provide("'+moduleId.replace(/\//g,".")+'");'+lineSeparator;for(var req,reqs=requireArgs,i=0;i<reqs.length;i++)req=reqs[i],req.substring(0,5)!="text!"&&(req.substring(0,5)=="i18n!"?(bundleMatch=req.match(/i18n\!(.+)\.nls\.(\w+)/),prefix+='dojo.requireLocalization("'+bundleMatch[1].replace(/\//g,".")+'", "'+bundleMatch[2]+'");'+lineSeparator):req!="dojo"&&req!="dijit"&&req!="dojox"&&!/^dojo\.lib/.test(req)&&(prefix+='dojo.require("'+req+'");'+lineSeparator));contents=contents.replace(/^\s*return\s+.+\/\/\s*AMD-return((\s.+)|(\s*))$/img,"");var matchLength=match.index+match[0].length+1,contentsLength=contents.search(/\s*return\s+[_a-zA-Z\.0-9]+\s*;\s*(\/\/.+)?\s*\}\);\s*$/);contentsLength==-1&&(contentsLength=contents.search(/\}\);\s*$/));return prefix+lineSeparator+contents.substring(matchLength,contentsLength)}return contents}return contents},fileUtil.copyFile=function(a,b,c){var d=new java.io.File(b);if(c){var e=new java.io.File(a);if(d.exists()&&d.lastModified()>=e.lastModified())return!1}var f=d.getParentFile();if(!f.exists())if(!f.mkdirs())throw"Could not create directory: "+f.getAbsolutePath();if(/.+\.js$/.test(a))fileUtil.saveUtf8File(b,fileUtil.transformAsyncModule(a,fileUtil.readFile(a)).replace(fileUtil.asyncFixEOLRe,"\n"));else{var g=(new java.io.FileInputStream(a)).getChannel(),h=(new java.io.FileOutputStream(b)).getChannel();h.transferFrom(g,0,g.size()),g.close(),h.close()}return!0},fileUtil.readFile=function(a,b){b=b||"utf-8";var c=new java.io.File(a),d=fileUtil.getLineSeparator(),e=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(c),b));try{var f=new java.lang.StringBuffer,g=e.readLine();g&&g.length()&&g.charAt(0)===65279&&(g=g.substring(1));while(g!==null)f.append(g),f.append(d),g=e.readLine();return new String(f.toString())}finally{e.close()}},fileUtil.saveUtf8File=function(a,b){fileUtil.saveFile(a,b,"utf-8")},fileUtil.saveFile=function(a,b,c){var d=new java.io.File(a),e,f=d.getParentFile();if(!f.exists())if(!f.mkdirs())throw"Could not create directory: "+f.getAbsolutePath();c?e=new java.io.OutputStreamWriter(new java.io.FileOutputStream(d),c):e=new java.io.OutputStreamWriter(new java.io.FileOutputStream(d));var g=new java.io.BufferedWriter(e);try{g.write(b)}finally{g.close()}},fileUtil.deleteFile=function(a){var b=new java.io.File(a);if(b.exists()){if(b.isDirectory()){var c=b.listFiles();for(var d=0;d<c.length;d++)this.deleteFile(c[d])}b["delete"]()}}