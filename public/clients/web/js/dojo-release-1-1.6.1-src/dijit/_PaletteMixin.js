define("dijit/_PaletteMixin",["dojo","dijit","dijit/_CssStateMixin"],function(a,b){a.declare("dijit._PaletteMixin",[b._CssStateMixin],{defaultTimeout:500,timeoutChangeRate:.9,value:null,_selectedCell:-1,tabIndex:"0",cellClass:"dijitPaletteCell",dyeClass:"",_preparePalette:function(c,d,e){this._cells=[];var f=this._blankGif;e=e||a.getObject(this.dyeClass);for(var g=0;g<c.length;g++){var h=a.create("tr",{tabIndex:"-1"},this.gridNode);for(var i=0;i<c[g].length;i++){var j=c[g][i];if(j){var k=new e(j,g,i),l=a.create("td",{"class":this.cellClass,tabIndex:"-1",title:d[j]});k.fillCell(l,f),this.connect(l,"ondijitclick","_onCellClick"),this._trackMouseState(l,this.cellClass),a.place(l,h),l.index=this._cells.length,this._cells.push({node:l,dye:k})}}}this._xDim=c[0].length,this._yDim=c.length;var m={UP_ARROW:-this._xDim,DOWN_ARROW:this._xDim,RIGHT_ARROW:this.isLeftToRight()?1:-1,LEFT_ARROW:this.isLeftToRight()?-1:1};for(var n in m)this._connects.push(b.typematic.addKeyListener(this.domNode,{charOrCode:a.keys[n],ctrlKey:!1,altKey:!1,shiftKey:!1},this,function(){var a=m[n];return function(b){this._navigateByKey(a,b)}}(),this.timeoutChangeRate,this.defaultTimeout))},postCreate:function(){this.inherited(arguments),this._setCurrent(this._cells[0].node)},focus:function(){b.focus(this._currentFocus)},_onCellClick:function(c){var d=c.currentTarget,e=this._getDye(d).getValue();this._setCurrent(d),setTimeout(a.hitch(this,function(){b.focus(d),this._setValueAttr(e,!0)})),a.removeClass(d,"dijitPaletteCellHover"),a.stopEvent(c)},_setCurrent:function(b){"_currentFocus"in this&&a.attr(this._currentFocus,"tabIndex","-1"),this._currentFocus=b,b&&a.attr(b,"tabIndex",this.tabIndex)},_setValueAttr:function(b,c){this._selectedCell>=0&&a.removeClass(this._cells[this._selectedCell].node,"dijitPaletteCellSelected"),this._selectedCell=-1;if(b)for(var d=0;d<this._cells.length;d++)if(b==this._cells[d].dye.getValue()){this._selectedCell=d,a.addClass(this._cells[d].node,"dijitPaletteCellSelected");break}this._set("value",this._selectedCell>=0?b:null),(c||c===undefined)&&this.onChange(b)},onChange:function(a){},_navigateByKey:function(c,d){if(d!=-1){var e=this._currentFocus.index+c;if(e<this._cells.length&&e>-1){var f=this._cells[e].node;this._setCurrent(f),setTimeout(a.hitch(b,"focus",f),0)}}},_getDye:function(a){return this._cells[a.index].dye}});return b._PaletteMixin})