define("dijit/_editor/plugins/FullScreen",["dojo","dijit","dojo/window","dojo/i18n","dijit/_editor/_Plugin","dijit/form/Button","i18n!dijit/_editor/nls/commands"],function(a,b){a.declare("dijit._editor.plugins.FullScreen",b._editor._Plugin,{zIndex:500,_origState:null,_origiFrameState:null,_resizeHandle:null,isFullscreen:!1,toggle:function(){this.button.set("checked",!this.button.get("checked"))},_initButton:function(){var c=a.i18n.getLocalization("dijit._editor","commands"),d=this.editor;this.button=new b.form.ToggleButton({label:c.fullScreen,dir:d.dir,lang:d.lang,showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"FullScreen",tabIndex:"-1",onChange:a.hitch(this,"_setFullScreen")})},setEditor:function(b){this.editor=b,this._initButton(),this.editor.addKeyHandler(a.keys.F11,!0,!0,a.hitch(this,function(b){this.toggle(),a.stopEvent(b),setTimeout(a.hitch(this,function(){this.editor.focus()}),250);return!0})),this.connect(this.editor.domNode,"onkeydown","_containFocus")},_containFocus:function(c){if(this.isFullscreen){var d=this.editor;if(!d.isTabIndent&&d._fullscreen_oldOnKeyDown&&c.keyCode===a.keys.TAB){var e=b.getFocus(),f=this._getAltViewNode();e.node==d.iframe||f&&e.node===f?setTimeout(a.hitch(this,function(){d.toolbar.focus()}),10):f&&a.style(d.iframe,"display")==="none"?setTimeout(a.hitch(this,function(){b.focus(f)}),10):setTimeout(a.hitch(this,function(){d.focus()}),10),a.stopEvent(c)}else d._fullscreen_oldOnKeyDown&&d._fullscreen_oldOnKeyDown(c)}},_resizeEditor:function(){var b=a.window.getBox();a.marginBox(this.editor.domNode,{w:b.w,h:b.h});var c=this.editor.getHeaderHeight(),d=this.editor.getFooterHeight(),e=a._getPadBorderExtents(this.editor.domNode),f=a._getPadBorderExtents(this.editor.iframe.parentNode),g=a._getMarginExtents(this.editor.iframe.parentNode),h=b.h-(c+e.h+d);a.marginBox(this.editor.iframe.parentNode,{h:h,w:b.w}),a.marginBox(this.editor.iframe,{h:h-(f.h+g.h)})},_getAltViewNode:function(){},_setFullScreen:function(c){var d=a.window.getBox(),e=this.editor,f=a.body(),g=e.domNode.parentNode;this.isFullscreen=c;if(c){while(g&&g!==a.body())a.addClass(g,"dijitForceStatic"),g=g.parentNode;this._editorResizeHolder=this.editor.resize,e.resize=function(){},e._fullscreen_oldOnKeyDown=e.onKeyDown,e.onKeyDown=a.hitch(this,this._containFocus),this._origState={},this._origiFrameState={};var h=e.domNode,i=h&&h.style||{};this._origState={width:i.width||"",height:i.height||"",top:a.style(h,"top")||"",left:a.style(h,"left")||"",position:a.style(h,"position")||"static",marginBox:a.marginBox(e.domNode)};var j=e.iframe,k=j&&j.style||{},l=a.style(e.iframe,"backgroundColor");this._origiFrameState={backgroundColor:l||"transparent",width:k.width||"auto",height:k.height||"auto",zIndex:k.zIndex||""},a.style(e.domNode,{position:"absolute",top:"0px",left:"0px",zIndex:this.zIndex,width:d.w+"px",height:d.h+"px"}),a.style(e.iframe,{height:"100%",width:"100%",zIndex:this.zIndex,backgroundColor:l!=="transparent"&&l!=="rgba(0, 0, 0, 0)"?l:"white"}),a.style(e.iframe.parentNode,{height:"95%",width:"100%"}),f.style&&f.style.overflow?this._oldOverflow=a.style(f,"overflow"):this._oldOverflow="";if(a.isIE&&!a.isQuirks){if(f.parentNode&&f.parentNode.style&&f.parentNode.style.overflow)this._oldBodyParentOverflow=f.parentNode.style.overflow;else try{this._oldBodyParentOverflow=a.style(f.parentNode,"overflow")}catch(m){this._oldBodyParentOverflow="scroll"}a.style(f.parentNode,"overflow","hidden")}a.style(f,"overflow","hidden");var n=function(){var b=a.window.getBox();if("_prevW"in this&&"_prevH"in this){if(b.w===this._prevW&&b.h===this._prevH)return}else this._prevW=b.w,this._prevH=b.h;this._resizer&&(clearTimeout(this._resizer),delete this._resizer),this._resizer=setTimeout(a.hitch(this,function(){delete this._resizer,this._resizeEditor()}),10)};this._resizeHandle=a.connect(window,"onresize",this,n),this._resizeHandle2=a.connect(e,"resize",a.hitch(this,function(){this._resizer&&(clearTimeout(this._resizer),delete this._resizer),this._resizer=setTimeout(a.hitch(this,function(){delete this._resizer,this._resizeEditor()}),10)})),this._resizeEditor();var o=this.editor.toolbar.domNode;setTimeout(function(){a.window.scrollIntoView(o)},250)}else{this._resizeHandle&&(a.disconnect(this._resizeHandle),this._resizeHandle=null),this._resizeHandle2&&(a.disconnect(this._resizeHandle2),this._resizeHandle2=null),this._rst&&(clearTimeout(this._rst),this._rst=null);while(g&&g!==a.body())a.removeClass(g,"dijitForceStatic"),g=g.parentNode;this._editorResizeHolder&&(this.editor.resize=this._editorResizeHolder);if(!this._origState&&!this._origiFrameState)return;e._fullscreen_oldOnKeyDown&&(e.onKeyDown=e._fullscreen_oldOnKeyDown,delete e._fullscreen_oldOnKeyDown);var p=this;setTimeout(function(){var c=p._origState.marginBox,d=p._origState.height;a.isIE&&!a.isQuirks&&(f.parentNode.style.overflow=p._oldBodyParentOverflow,delete p._oldBodyParentOverflow),a.style(f,"overflow",p._oldOverflow),delete p._oldOverflow,a.style(e.domNode,p._origState),a.style(e.iframe.parentNode,{height:"",width:""}),a.style(e.iframe,p._origiFrameState),delete p._origState,delete p._origiFrameState;var g=b.getEnclosingWidget(e.domNode.parentNode);g&&g.resize?g.resize():(!d||d.indexOf("%")<0)&&setTimeout(a.hitch(this,function(){e.resize({h:c.h})}),0),a.window.scrollIntoView(p.editor.toolbar.domNode)},100)}},updateState:function(){this.button.set("disabled",this.get("disabled"))},destroy:function(){this._resizeHandle&&(a.disconnect(this._resizeHandle),this._resizeHandle=null),this._resizeHandle2&&(a.disconnect(this._resizeHandle2),this._resizeHandle2=null),this._resizer&&(clearTimeout(this._resizer),this._resizer=null),this.inherited(arguments)}}),a.subscribe(b._scopeName+".Editor.getPlugin",null,function(a){if(!a.plugin){var c=a.args.name.toLowerCase();c==="fullscreen"&&(a.plugin=new b._editor.plugins.FullScreen({zIndex:"zIndex"in a.args?a.args.zIndex:500}))}});return b._editor.plugins.FullScreen})