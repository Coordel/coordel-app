define("dijit/layout/ScrollingTabController",["dojo","dijit","text!dijit/layout/templates/ScrollingTabController.html","text!dijit/layout/templates/_ScrollingTabControllerButton.html","dijit/layout/TabController","dijit/Menu","dijit/form/Button","dijit/_HasDropDown"],function(a,b){a.declare("dijit.layout.ScrollingTabController",b.layout.TabController,{templateString:a.cache("dijit.layout","templates/ScrollingTabController.html"),useMenu:!0,useSlider:!0,tabStripClass:"",widgetsInTemplate:!0,_minScroll:5,attributeMap:a.delegate(b._Widget.prototype.attributeMap,{"class":"containerNode"}),buildRendering:function(){this.inherited(arguments);var b=this.domNode;this.scrollNode=this.tablistWrapper,this._initButtons(),this.tabStripClass||(this.tabStripClass="dijitTabContainer"+this.tabPosition.charAt(0).toUpperCase()+this.tabPosition.substr(1).replace(/-.*/,"")+"None",a.addClass(b,"tabStrip-disabled")),a.addClass(this.tablistWrapper,this.tabStripClass)},onStartup:function(){this.inherited(arguments),a.style(this.domNode,"visibility","visible"),this._postStartup=!0},onAddChild:function(b,c){this.inherited(arguments),a.forEach(["label","iconClass"],function(c){this.pane2watches[b.id].push(this.pane2button[b.id].watch(c,a.hitch(this,function(a,b,c){this._postStartup&&this._dim&&this.resize(this._dim)})))},this),a.style(this.containerNode,"width",a.style(this.containerNode,"width")+200+"px")},onRemoveChild:function(a,b){var c=this.pane2button[a.id];this._selectedTab===c.domNode&&(this._selectedTab=null),this.inherited(arguments)},_initButtons:function(){this._btnWidth=0,this._buttons=a.query("> .tabStripButton",this.domNode).filter(function(b){if(this.useMenu&&b==this._menuBtn.domNode||this.useSlider&&(b==this._rightBtn.domNode||b==this._leftBtn.domNode)){this._btnWidth+=a._getMarginSize(b).w;return!0}a.style(b,"display","none");return!1},this)},_getTabsWidth:function(){var b=this.getChildren();if(b.length){var c=b[this.isLeftToRight()?0:b.length-1].domNode,d=b[this.isLeftToRight()?b.length-1:0].domNode;return d.offsetLeft+a.style(d,"width")-c.offsetLeft}return 0},_enableBtn:function(b){var c=this._getTabsWidth();b=b||a.style(this.scrollNode,"width");return c>0&&b<c},resize:function(c){if(this.domNode.offsetWidth!=0){this._dim=c,this.scrollNode.style.height="auto",this._contentBox=b.layout.marginBox2contentBox(this.domNode,{h:0,w:c.w}),this._contentBox.h=this.scrollNode.offsetHeight,a.contentBox(this.domNode,this._contentBox);var d=this._enableBtn(this._contentBox.w);this._buttons.style("display",d?"":"none"),this._leftBtn.layoutAlign="left",this._rightBtn.layoutAlign="right",this._menuBtn.layoutAlign=this.isLeftToRight()?"right":"left",b.layout.layoutChildren(this.domNode,this._contentBox,[this._menuBtn,this._leftBtn,this._rightBtn,{domNode:this.scrollNode,layoutAlign:"client"}]);if(this._selectedTab){this._anim&&this._anim.status()=="playing"&&this._anim.stop();var e=this.scrollNode,f=this._convertToScrollLeft(this._getScrollForSelectedTab());e.scrollLeft=f}this._setButtonClass(this._getScroll()),this._postResize=!0;return{h:this._contentBox.h,w:c.w}}},_getScroll:function(){var b=this.isLeftToRight()||a.isIE<8||a.isIE&&a.isQuirks||a.isWebKit?this.scrollNode.scrollLeft:a.style(this.containerNode,"width")-a.style(this.scrollNode,"width")+(a.isIE==8?-1:1)*this.scrollNode.scrollLeft;return b},_convertToScrollLeft:function(b){if(this.isLeftToRight()||a.isIE<8||a.isIE&&a.isQuirks||a.isWebKit)return b;var c=a.style(this.containerNode,"width")-a.style(this.scrollNode,"width");return(a.isIE==8?-1:1)*(b-c)},onSelectChild:function(b){var c=this.pane2button[b.id];if(c&&b){var d=c.domNode;if(this._postResize&&d!=this._selectedTab){this._selectedTab=d;var e=this._getScroll();(e>d.offsetLeft||e+a.style(this.scrollNode,"width")<d.offsetLeft+a.style(d,"width"))&&this.createSmoothScroll().play()}this.inherited(arguments)}},_getScrollBounds:function(){var b=this.getChildren(),c=a.style(this.scrollNode,"width"),d=a.style(this.containerNode,"width"),e=d-c,f=this._getTabsWidth();if(b.length&&f>c)return{min:this.isLeftToRight()?0:b[b.length-1].domNode.offsetLeft,max:this.isLeftToRight()?b[b.length-1].domNode.offsetLeft+a.style(b[b.length-1].domNode,"width")-c:e};var g=this.isLeftToRight()?0:e;return{min:g,max:g}},_getScrollForSelectedTab:function(){var b=this.scrollNode,c=this._selectedTab,d=a.style(this.scrollNode,"width"),e=this._getScrollBounds(),f=c.offsetLeft+a.style(c,"width")/2-d/2;f=Math.min(Math.max(f,e.min),e.max);return f},createSmoothScroll:function(b){if(arguments.length>0){var c=this._getScrollBounds();b=Math.min(Math.max(b,c.min),c.max)}else b=this._getScrollForSelectedTab();this._anim&&this._anim.status()=="playing"&&this._anim.stop();var d=this,e=this.scrollNode,f=new a._Animation({beforeBegin:function(){this.curve&&delete this.curve;var c=e.scrollLeft,g=d._convertToScrollLeft(b);f.curve=new a._Line(c,g)},onAnimate:function(a){e.scrollLeft=a}});this._anim=f,this._setButtonClass(b);return f},_getBtnNode:function(b){var c=b.target;while(c&&!a.hasClass(c,"tabStripButton"))c=c.parentNode;return c},doSlideRight:function(a){this.doSlide(1,this._getBtnNode(a))},doSlideLeft:function(a){this.doSlide(-1,this._getBtnNode(a))},doSlide:function(b,c){if(!c||!a.hasClass(c,"dijitTabDisabled")){var d=a.style(this.scrollNode,"width"),e=d*.75*b,f=this._getScroll()+e;this._setButtonClass(f),this.createSmoothScroll(f).play()}},_setButtonClass:function(a){var b=this._getScrollBounds();this._leftBtn.set("disabled",a<=b.min),this._rightBtn.set("disabled",a>=b.max)}}),a.declare("dijit.layout._ScrollingTabControllerButtonMixin",null,{baseClass:"dijitTab tabStripButton",templateString:a.cache("dijit.layout","templates/_ScrollingTabControllerButton.html"),tabIndex:"",isFocusable:function(){return!1}}),a.declare("dijit.layout._ScrollingTabControllerButton",[b.form.Button,b.layout._ScrollingTabControllerButtonMixin]),a.declare("dijit.layout._ScrollingTabControllerMenuButton",[b.form.Button,b._HasDropDown,b.layout._ScrollingTabControllerButtonMixin],{containerId:"",tabIndex:"-1",isLoaded:function(){return!1},loadDropDown:function(c){this.dropDown=new b.Menu({id:this.containerId+"_menu",dir:this.dir,lang:this.lang});var d=b.byId(this.containerId);a.forEach(d.getChildren(),function(a){var c=new b.MenuItem({id:a.id+"_stcMi",label:a.title,iconClass:a.iconClass,dir:a.dir,lang:a.lang,onClick:function(){d.selectChild(a)}});this.dropDown.addChild(c)},this),c()},closeDropDown:function(a){this.inherited(arguments),this.dropDown&&(this.dropDown.destroyRecursive(),delete this.dropDown)}});return b.layout.ScrollingTabController})