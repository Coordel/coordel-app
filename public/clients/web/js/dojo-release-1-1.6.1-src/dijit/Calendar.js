define("dijit/Calendar",["dojo","dijit","text!dijit/templates/Calendar.html","dojo/cldr/supplemental","dojo/date","dojo/date/locale","dijit/_Widget","dijit/_Templated","dijit/_CssStateMixin","dijit/form/DropDownButton"],function(a,b){a.declare("dijit.Calendar",[b._Widget,b._Templated,b._CssStateMixin],{templateString:a.cache("dijit","templates/Calendar.html"),widgetsInTemplate:!0,value:new Date(""),datePackage:"dojo.date",dayWidth:"narrow",tabIndex:"0",currentFocus:new Date,baseClass:"dijitCalendar",cssStateNodes:{decrementMonth:"dijitCalendarArrow",incrementMonth:"dijitCalendarArrow",previousYearLabelNode:"dijitCalendarPreviousYear",nextYearLabelNode:"dijitCalendarNextYear"},_isValidDate:function(a){return a&&!isNaN(a)&&typeof a=="object"&&a.toString()!=this.constructor.prototype.value.toString()},setValue:function(b){a.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0"),this.set("value",b)},_getValueAttr:function(){var a=new this.dateClassObj(this.value);a.setHours(0,0,0,0),a.getDate()<this.value.getDate()&&(a=this.dateFuncObj.add(a,"hour",1));return a},_setValueAttr:function(a,b){a&&(a=new this.dateClassObj(a));if(this._isValidDate(a)){if(!this._isValidDate(this.value)||this.dateFuncObj.compare(a,this.value)){a.setHours(1,0,0,0);if(!this.isDisabledDate(a,this.lang)){this._set("value",a),this.set("currentFocus",a);if(b||typeof b=="undefined")this.onChange(this.get("value")),this.onValueSelected(this.get("value"))}}}else this._set("value",null),this.set("currentFocus",this.currentFocus)},_setText:function(b,c){while(b.firstChild)b.removeChild(b.firstChild);b.appendChild(a.doc.createTextNode(c))},_populateGrid:function(){var b=new this.dateClassObj(this.currentFocus);b.setDate(1);var c=b.getDay(),d=this.dateFuncObj.getDaysInMonth(b),e=this.dateFuncObj.getDaysInMonth(this.dateFuncObj.add(b,"month",-1)),f=new this.dateClassObj,g=a.cldr.supplemental.getFirstDayOfWeek(this.lang);g>c&&(g-=7),a.query(".dijitCalendarDateTemplate",this.domNode).forEach(function(h,i){i+=g;var j=new this.dateClassObj(b),k,l="dijitCalendar",m=0;i<c?(k=e-c+i+1,m=-1,l+="Previous"):i<c+d?(k=i-c+1,l+="Current"):(k=i-c-d+1,m=1,l+="Next"),m&&(j=this.dateFuncObj.add(j,"month",m)),j.setDate(k),this.dateFuncObj.compare(j,f,"date")||(l="dijitCalendarCurrentDate "+l),this._isSelectedDate(j,this.lang)&&(l="dijitCalendarSelectedDate "+l),this.isDisabledDate(j,this.lang)&&(l="dijitCalendarDisabledDate "+l);var n=this.getClassForDate(j,this.lang);n&&(l=n+" "+l),h.className=l+"Month dijitCalendarDateTemplate",h.dijitDateValue=j.valueOf(),a.attr(h,"dijitDateValue",j.valueOf());var o=a.query(".dijitCalendarDateLabel",h)[0],p=j.getDateLocalized?j.getDateLocalized(this.lang):j.getDate();this._setText(o,p)},this);var h=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,b);this.monthDropDownButton.dropDown.set("months",h),this.monthDropDownButton.containerNode.innerHTML=(a.isIE==6?"":"<div class='dijitSpacer'>"+this.monthDropDownButton.dropDown.domNode.innerHTML+"</div>")+"<div class='dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'>"+h[b.getMonth()]+"</div>";var i=b.getFullYear()-1,j=new this.dateClassObj;a.forEach(["previous","current","next"],function(a){j.setFullYear(i++),this._setText(this[a+"YearLabelNode"],this.dateLocaleModule.format(j,{selector:"year",locale:this.lang}))},this)},goToToday:function(){this.set("value",new this.dateClassObj)},constructor:function(b){var c=b.datePackage&&b.datePackage!="dojo.date"?b.datePackage+".Date":"Date";this.dateClassObj=a.getObject(c,!1),this.datePackage=b.datePackage||this.datePackage,this.dateFuncObj=a.getObject(this.datePackage,!1),this.dateLocaleModule=a.getObject(this.datePackage+".locale",!1)},postMixInProperties:function(){isNaN(this.value)&&delete this.value,this.inherited(arguments)},buildRendering:function(){this.inherited(arguments),a.setSelectable(this.domNode,!1);var c=a.hitch(this,function(b,c){var d=a.query(b,this.domNode)[0];for(var e=0;e<c;e++)d.parentNode.appendChild(d.cloneNode(!0))});c(".dijitCalendarDayLabelTemplate",6),c(".dijitCalendarDateTemplate",6),c(".dijitCalendarWeekTemplate",5);var d=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),e=a.cldr.supplemental.getFirstDayOfWeek(this.lang);a.query(".dijitCalendarDayLabel",this.domNode).forEach(function(a,b){this._setText(a,d[(b+e)%7])},this);var f=new this.dateClassObj(this.currentFocus);this.monthDropDownButton.dropDown=new b.Calendar._MonthDropDown({id:this.id+"_mdd",onChange:a.hitch(this,"_onMonthSelect")}),this.set("currentFocus",f,!1);var g=this,h=function(a,c,d){g._connects.push(b.typematic.addMouseListener(g[a],g,function(a){a>=0&&g._adjustDisplay(c,d)},.8,500))};h("incrementMonth","month",1),h("decrementMonth","month",-1),h("nextYearLabelNode","year",1),h("previousYearLabelNode","year",-1)},_adjustDisplay:function(a,b){this._setCurrentFocusAttr(this.dateFuncObj.add(this.currentFocus,a,b))},_setCurrentFocusAttr:function(b,c){var d=this.currentFocus,e=d?a.query("[dijitDateValue="+d.valueOf()+"]",this.domNode)[0]:null;b=new this.dateClassObj(b),b.setHours(1,0,0,0),this._set("currentFocus",b),this._populateGrid();var f=a.query("[dijitDateValue="+b.valueOf()+"]",this.domNode)[0];f.setAttribute("tabIndex",this.tabIndex),(this._focused||c)&&f.focus(),e&&e!=f&&(a.isWebKit?e.setAttribute("tabIndex","-1"):e.removeAttribute("tabIndex"))},focus:function(){this._setCurrentFocusAttr(this.currentFocus,!0)},_onMonthSelect:function(a){this.currentFocus=this.dateFuncObj.add(this.currentFocus,"month",a-this.currentFocus.getMonth()),this._populateGrid()},_onDayClick:function(b){a.stopEvent(b);for(var c=b.target;c&&!c.dijitDateValue;c=c.parentNode);c&&!a.hasClass(c,"dijitCalendarDisabledDate")&&this.set("value",c.dijitDateValue)},_onDayMouseOver:function(b){var c=a.hasClass(b.target,"dijitCalendarDateLabel")?b.target.parentNode:b.target;c&&(c.dijitDateValue||c==this.previousYearLabelNode||c==this.nextYearLabelNode)&&(a.addClass(c,"dijitCalendarHoveredDate"),this._currentNode=c)},_onDayMouseOut:function(b){if(this._currentNode){if(b.relatedTarget&&b.relatedTarget.parentNode==this._currentNode)return;var c="dijitCalendarHoveredDate";a.hasClass(this._currentNode,"dijitCalendarActiveDate")&&(c+=" dijitCalendarActiveDate"),a.removeClass(this._currentNode,c),this._currentNode=null}},_onDayMouseDown:function(b){var c=b.target.parentNode;c&&c.dijitDateValue&&(a.addClass(c,"dijitCalendarActiveDate"),this._currentNode=c)},_onDayMouseUp:function(b){var c=b.target.parentNode;c&&c.dijitDateValue&&a.removeClass(c,"dijitCalendarActiveDate")},handleKey:function(b){var c=a.keys,d=-1,e,f=this.currentFocus;switch(b.keyCode){case c.RIGHT_ARROW:d=1;case c.LEFT_ARROW:e="day",this.isLeftToRight()||(d*=-1);break;case c.DOWN_ARROW:d=1;case c.UP_ARROW:e="week";break;case c.PAGE_DOWN:d=1;case c.PAGE_UP:e=b.ctrlKey||b.altKey?"year":"month";break;case c.END:f=this.dateFuncObj.add(f,"month",1),e="day";case c.HOME:f=new this.dateClassObj(f),f.setDate(1);break;case c.ENTER:case c.SPACE:this.set("value",this.currentFocus);break;default:return!0}e&&(f=this.dateFuncObj.add(f,e,d)),this._setCurrentFocusAttr(f);return!1},_onKeyPress:function(b){this.handleKey(b)||a.stopEvent(b)},onValueSelected:function(a){},onChange:function(a){},_isSelectedDate:function(a,b){return this._isValidDate(this.value)&&!this.dateFuncObj.compare(a,this.value,"date")},isDisabledDate:function(a,b){},getClassForDate:function(a,b){}}),a.declare("dijit.Calendar._MonthDropDown",[b._Widget,b._Templated],{months:[],templateString:"<div class='dijitCalendarMonthMenu dijitMenu' dojoAttachEvent='onclick:_onClick,onmouseover:_onMenuHover,onmouseout:_onMenuHover'></div>",_setMonthsAttr:function(b){this.domNode.innerHTML=a.map(b,function(a,b){return a?"<div class='dijitCalendarMonthLabel' month='"+b+"'>"+a+"</div>":""}).join("")},_onClick:function(b){this.onChange(a.attr(b.target,"month"))},onChange:function(a){},_onMenuHover:function(b){a.toggleClass(b.target,"dijitCalendarMonthLabelHover",b.type=="mouseover")}});return b.Calendar})