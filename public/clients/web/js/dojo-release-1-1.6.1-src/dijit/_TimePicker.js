define("dijit/_TimePicker",["dojo","dijit","text!dijit/templates/TimePicker.html","dijit/form/_FormWidget","dojo/date/locale"],function(a,b){a.declare("dijit._TimePicker",[b._Widget,b._Templated],{templateString:a.cache("dijit","templates/TimePicker.html"),baseClass:"dijitTimePicker",clickableIncrement:"T00:15:00",visibleIncrement:"T01:00:00",visibleRange:"T05:00:00",value:new Date,_visibleIncrement:2,_clickableIncrement:1,_totalIncrements:10,constraints:{},serialize:a.date.stamp.toISOString,setValue:function(b){a.deprecated("dijit._TimePicker:setValue() is deprecated.  Use set('value', ...) instead.","","2.0"),this.set("value",b)},_setValueAttr:function(a){this._set("value",a),this._showText()},_setFilterStringAttr:function(a){this._set("filterString",a),this._showText()},isDisabledDate:function(a,b){return!1},_getFilteredNodes:function(a,b,c,d){var e=[],f=d?d.date:this._refDate,g,h=a,i=this._maxIncrement+Math.abs(h),j=c?-1:1,k=c?1:0,l=1-k;do{h=h-k,g=this._createOption(h);if(g){if(c&&g.date>f||!c&&g.date<f)break;e[c?"unshift":"push"](g),f=g.date}h=h+l}while(e.length<b&&h*j<i);return e},_showText:function(){var b=a.date.stamp.fromISOString;this.timeMenu.innerHTML="",this._clickableIncrementDate=b(this.clickableIncrement),this._visibleIncrementDate=b(this.visibleIncrement),this._visibleRangeDate=b(this.visibleRange);var c=function(a){return a.getHours()*60*60+a.getMinutes()*60+a.getSeconds()},d=c(this._clickableIncrementDate),e=c(this._visibleIncrementDate),f=c(this._visibleRangeDate),g=(this.value||this.currentFocus).getTime();this._refDate=new Date(g-g%(e*1e3)),this._refDate.setFullYear(1970,0,1),this._clickableIncrement=1,this._totalIncrements=f/d,this._visibleIncrement=e/d,this._maxIncrement=86400/d;var h=this._getFilteredNodes(0,Math.min(this._totalIncrements>>1,10)-1),i=this._getFilteredNodes(0,Math.min(this._totalIncrements,10)-h.length,!0,h[0]);a.forEach(i.concat(h),function(a){this.timeMenu.appendChild(a)},this)},constructor:function(){this.constraints={}},postMixInProperties:function(){this.inherited(arguments),this._setConstraintsAttr(this.constraints)},_setConstraintsAttr:function(b){a.mixin(this,b),b.locale||(b.locale=this.lang)},postCreate:function(){this.connect(this.timeMenu,a.isIE?"onmousewheel":"DOMMouseScroll","_mouseWheeled"),this._connects.push(b.typematic.addMouseListener(this.upArrow,this,"_onArrowUp",33,250)),this._connects.push(b.typematic.addMouseListener(this.downArrow,this,"_onArrowDown",33,250)),this.inherited(arguments)},_buttonMouse:function(b){a.toggleClass(b.currentTarget,b.currentTarget==this.upArrow?"dijitUpArrowHover":"dijitDownArrowHover",b.type=="mouseenter"||b.type=="mouseover")},_createOption:function(b){var c=new Date(this._refDate),d=this._clickableIncrementDate;c.setHours(c.getHours()+d.getHours()*b,c.getMinutes()+d.getMinutes()*b,c.getSeconds()+d.getSeconds()*b),this.constraints.selector=="time"&&c.setFullYear(1970,0,1);var e=a.date.locale.format(c,this.constraints);if(this.filterString&&e.toLowerCase().indexOf(this.filterString)!==0)return null;var f=a.create("div",{"class":this.baseClass+"Item"});f.date=c,f.index=b,a.create("div",{"class":this.baseClass+"ItemInner",innerHTML:e},f),b%this._visibleIncrement<1&&b%this._visibleIncrement>-1?a.addClass(f,this.baseClass+"Marker"):b%this._clickableIncrement||a.addClass(f,this.baseClass+"Tick"),this.isDisabledDate(c)&&a.addClass(f,this.baseClass+"ItemDisabled"),this.value&&!a.date.compare(this.value,c,this.constraints.selector)&&(f.selected=!0,a.addClass(f,this.baseClass+"ItemSelected"),a.hasClass(f,this.baseClass+"Marker")?a.addClass(f,this.baseClass+"MarkerSelected"):a.addClass(f,this.baseClass+"TickSelected"),this._highlightOption(f,!0));return f},_onOptionSelected:function(a){var b=a.target.date||a.target.parentNode.date;b&&!this.isDisabledDate(b)&&(this._highlighted_option=null,this.set("value",b),this.onChange(b))},onChange:function(a){},_highlightOption:function(b,c){if(b){if(c)this._highlighted_option&&this._highlightOption(this._highlighted_option,!1),this._highlighted_option=b;else{if(this._highlighted_option!==b)return;this._highlighted_option=null}a.toggleClass(b,this.baseClass+"ItemHover",c),a.hasClass(b,this.baseClass+"Marker")?a.toggleClass(b,this.baseClass+"MarkerHover",c):a.toggleClass(b,this.baseClass+"TickHover",c)}},onmouseover:function(b){this._keyboardSelected=null;var c=b.target.parentNode===this.timeMenu?b.target:b.target.parentNode;a.hasClass(c,this.baseClass+"Item")&&this._highlightOption(c,!0)},onmouseout:function(a){this._keyboardSelected=null;var b=a.target.parentNode===this.timeMenu?a.target:a.target.parentNode;this._highlightOption(b,!1)},_mouseWheeled:function(b){this._keyboardSelected=null,a.stopEvent(b);var c=a.isIE?b.wheelDelta:-b.detail;this[c>0?"_onArrowUp":"_onArrowDown"]()},_onArrowUp:function(a){if(typeof a!="number"||a!=-1){if(!this.timeMenu.childNodes.length)return;var b=this.timeMenu.childNodes[0].index,c=this._getFilteredNodes(b,1,!0,this.timeMenu.childNodes[0]);c.length&&(this.timeMenu.removeChild(this.timeMenu.childNodes[this.timeMenu.childNodes.length-1]),this.timeMenu.insertBefore(c[0],this.timeMenu.childNodes[0]))}},_onArrowDown:function(a){if(typeof a!="number"||a!=-1){if(!this.timeMenu.childNodes.length)return;var b=this.timeMenu.childNodes[this.timeMenu.childNodes.length-1].index+1,c=this._getFilteredNodes(b,1,!1,this.timeMenu.childNodes[this.timeMenu.childNodes.length-1]);c.length&&(this.timeMenu.removeChild(this.timeMenu.childNodes[0]),this.timeMenu.appendChild(c[0]))}},handleKey:function(b){var c=a.keys;if(b.charOrCode==c.DOWN_ARROW||b.charOrCode==c.UP_ARROW){a.stopEvent(b),this._highlighted_option&&!this._highlighted_option.parentNode&&(this._highlighted_option=null);var d=this.timeMenu,e=this._highlighted_option||a.query("."+this.baseClass+"ItemSelected",d)[0];e?d.childNodes.length&&(b.charOrCode!=c.DOWN_ARROW||e.nextSibling?b.charOrCode==c.UP_ARROW&&!e.previousSibling&&this._onArrowUp():this._onArrowDown(),b.charOrCode==c.DOWN_ARROW?e=e.nextSibling:e=e.previousSibling):e=d.childNodes[0],this._highlightOption(e,!0),this._keyboardSelected=e;return!1}if(b.charOrCode==c.ENTER||b.charOrCode===c.TAB){if(!this._keyboardSelected&&b.charOrCode===c.TAB)return!0;this._highlighted_option&&this._onOptionSelected({target:this._highlighted_option});return b.charOrCode===c.TAB}}});return b._TimePicker})