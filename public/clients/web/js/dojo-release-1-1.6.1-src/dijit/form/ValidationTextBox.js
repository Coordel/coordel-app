define("dijit/form/ValidationTextBox",["dojo","dijit","text!dijit/form/templates/ValidationTextBox.html","dojo/i18n","dijit/form/TextBox","dijit/Tooltip","i18n!dijit/form/nls/validate"],function(a,b){a.declare("dijit.form.ValidationTextBox",b.form.TextBox,{templateString:a.cache("dijit.form","templates/ValidationTextBox.html"),baseClass:"dijitTextBox dijitValidationTextBox",required:!1,promptMessage:"",invalidMessage:"$_unset_$",missingMessage:"$_unset_$",message:"",constraints:{},regExp:".*",regExpGen:function(a){return this.regExp},state:"",tooltipPosition:[],_setValueAttr:function(){this.inherited(arguments),this.validate(this._focused)},validator:function(a,b){return(new RegExp("^(?:"+this.regExpGen(b)+")"+(this.required?"":"?")+"$")).test(a)&&(!this.required||!this._isEmpty(a))&&(this._isEmpty(a)||this.parse(a,b)!==undefined)},_isValidSubset:function(){return this.textbox.value.search(this._partialre)==0},isValid:function(a){return this.validator(this.textbox.value,this.constraints)},_isEmpty:function(a){return(this.trim?/^\s*$/:/^$/).test(a)},getErrorMessage:function(a){return this.required&&this._isEmpty(this.textbox.value)?this.missingMessage:this.invalidMessage},getPromptMessage:function(a){return this.promptMessage},_maskValidSubsetError:!0,validate:function(a){var c="",d=this.disabled||this.isValid(a);d&&(this._maskValidSubsetError=!0);var e=this._isEmpty(this.textbox.value),f=!d&&a&&this._isValidSubset();this._set("state",d?"":((!this._hasBeenBlurred||a)&&e||f)&&this._maskValidSubsetError?"Incomplete":"Error"),b.setWaiState(this.focusNode,"invalid",d?"false":"true"),this.state=="Error"?(this._maskValidSubsetError=a&&f,c=this.getErrorMessage(a)):this.state=="Incomplete"?(c=this.getPromptMessage(a),this._maskValidSubsetError=!this._hasBeenBlurred||a):e&&(c=this.getPromptMessage(a)),this.set("message",c);return d},displayMessage:function(a){b.hideTooltip(this.domNode),a&&this._focused&&b.showTooltip(a,this.domNode,this.tooltipPosition,!this.isLeftToRight())},_refreshState:function(){this.validate(this._focused),this.inherited(arguments)},constructor:function(){this.constraints={}},_setConstraintsAttr:function(a){!a.locale&&this.lang&&(a.locale=this.lang),this._set("constraints",a),this._computePartialRE()},_computePartialRE:function(){var a=this.regExpGen(this.constraints);this.regExp=a;var b="";a!=".*"&&this.regExp.replace(/\\.|\[\]|\[.*?[^\\]{1}\]|\{.*?\}|\(\?[=:!]|./g,function(a){switch(a.charAt(0)){case"{":case"+":case"?":case"*":case"^":case"$":case"|":case"(":b+=a;break;case")":b+="|$)";break;default:b+="(?:"+a+"|$)"}});try{"".search(b)}catch(c){b=this.regExp,console.warn("RegExp error in "+this.declaredClass+": "+this.regExp)}this._partialre="^(?:"+b+")$"},postMixInProperties:function(){this.inherited(arguments),this.messages=a.i18n.getLocalization("dijit.form","validate",this.lang),this.invalidMessage=="$_unset_$"&&(this.invalidMessage=this.messages.invalidMessage),this.invalidMessage||(this.invalidMessage=this.promptMessage),this.missingMessage=="$_unset_$"&&(this.missingMessage=this.messages.missingMessage),this.missingMessage||(this.missingMessage=this.invalidMessage),this._setConstraintsAttr(this.constraints)},_setDisabledAttr:function(a){this.inherited(arguments),this._refreshState()},_setRequiredAttr:function(a){this._set("required",a),b.setWaiState(this.focusNode,"required",a),this._refreshState()},_setMessageAttr:function(a){this._set("message",a),this.displayMessage(a)},reset:function(){this._maskValidSubsetError=!0,this.inherited(arguments)},_onBlur:function(){this.displayMessage(""),this.inherited(arguments)}}),a.declare("dijit.form.MappedTextBox",b.form.ValidationTextBox,{postMixInProperties:function(){this.inherited(arguments),this.nameAttrSetting=""},serialize:function(a,b){return a.toString?a.toString():""},toString:function(){var a=this.filter(this.get("value"));return a!=null?typeof a=="string"?a:this.serialize(a,this.constraints):""},validate:function(){this.valueNode.value=this.toString();return this.inherited(arguments)},buildRendering:function(){this.inherited(arguments),this.valueNode=a.place("<input type='hidden'"+(this.name?" name='"+this.name.replace(/'/g,"&quot;")+"'":"")+"/>",this.textbox,"after")},reset:function(){this.valueNode.value="",this.inherited(arguments)}}),a.declare("dijit.form.RangeBoundTextBox",b.form.MappedTextBox,{rangeMessage:"",rangeCheck:function(a,b){return("min"in b?this.compare(a,b.min)>=0:!0)&&("max"in b?this.compare(a,b.max)<=0:!0)},isInRange:function(a){return this.rangeCheck(this.get("value"),this.constraints)},_isDefinitelyOutOfRange:function(){var a=this.get("value"),b=!1,c=!1;if("min"in this.constraints){var d=this.constraints.min;d=this.compare(a,typeof d=="number"&&d>=0&&a!=0?0:d),b=typeof d=="number"&&d<0}if("max"in this.constraints){var e=this.constraints.max;e=this.compare(a,typeof e!="number"||e>0?e:0),c=typeof e=="number"&&e>0}return b||c},_isValidSubset:function(){return this.inherited(arguments)&&!this._isDefinitelyOutOfRange()},isValid:function(a){return this.inherited(arguments)&&(this._isEmpty(this.textbox.value)&&!this.required||this.isInRange(a))},getErrorMessage:function(a){var b=this.get("value");if(b!==null&&b!==""&&b!==undefined&&(typeof b!="number"||!isNaN(b))&&!this.isInRange(a))return this.rangeMessage;return this.inherited(arguments)},postMixInProperties:function(){this.inherited(arguments),this.rangeMessage||(this.messages=a.i18n.getLocalization("dijit.form","validate",this.lang),this.rangeMessage=this.messages.rangeMessage)},_setConstraintsAttr:function(a){this.inherited(arguments),this.focusNode&&(this.constraints.min!==undefined?b.setWaiState(this.focusNode,"valuemin",this.constraints.min):b.removeWaiState(this.focusNode,"valuemin"),this.constraints.max!==undefined?b.setWaiState(this.focusNode,"valuemax",this.constraints.max):b.removeWaiState(this.focusNode,"valuemax"))},_setValueAttr:function(a,c){b.setWaiState(this.focusNode,"valuenow",a),this.inherited(arguments)}});return b.form.ValidationTextBox})