dojo.provide("dojox.form.manager._Mixin"),dojo.require("dijit._Widget"),function(){var a=dojox.form.manager,b=a.actionAdapter=function(a){return function(b,c,d){dojo.isArray(c)?dojo.forEach(c,function(c){a.call(this,b,c,d)},this):a.apply(this,arguments)}},c=a.inspectorAdapter=function(a){return function(b,c,d){return a.call(this,b,dojo.isArray(c)?c[0]:c,d)}},d={domNode:1,containerNode:1,srcNodeRef:1,bgIframe:1},e=a._keys=function(a){var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(c);return b},f=function(a){var b=a.get("name");if(b&&a instanceof dijit.form._FormWidget)if(b in this.formWidgets){var c=this.formWidgets[b].widget;dojo.isArray(c)?c.push(a):this.formWidgets[b].widget=[c,a]}else this.formWidgets[b]={widget:a,connections:[]};else b=null;return b},g=function(a){var c={};b(function(a,b){var d=b.get("observer");d&&typeof d=="string"&&dojo.forEach(d.split(","),function(a){a=dojo.trim(a),a&&dojo.isFunction(this[a])&&(c[a]=1)},this)}).call(this,null,this.formWidgets[a].widget);return e(c)},h=function(a,b){var c=this.formWidgets[a],d=c.widget,e=c.connections;e.length&&(dojo.forEach(e,dojo.disconnect),e=c.connections=[]);if(dojo.isArray(d))dojo.forEach(d,function(c){dojo.forEach(b,function(b){e.push(dojo.connect(c,"onChange",this,function(d){this.watching&&dojo.attr(c.focusNode,"checked")&&this[b](c.get("value"),a,c,d)}))},this)},this);else{var f=d.declaredClass=="dijit.form.Button"?"onClick":"onChange";dojo.forEach(b,function(b){e.push(dojo.connect(d,f,this,function(c){this.watching&&this[b](d.get("value"),a,d,c)}))},this)}};dojo.declare("dojox.form.manager._Mixin",null,{watching:!0,startup:function(){this._started||(this.formWidgets={},this.formNodes={},this.registerWidgetDescendants(this),this.inherited(arguments))},destroy:function(){for(var a in this.formWidgets)dojo.forEach(this.formWidgets[a].connections,dojo.disconnect);this.formWidgets={},this.inherited(arguments)},registerWidget:function(a){typeof a=="string"?a=dijit.byId(a):a.tagName&&a.cloneNode&&(a=dijit.byNode(a));var b=f.call(this,a);b&&h.call(this,b,g.call(this,b));return this},unregisterWidget:function(a){a in this.formWidgets&&(dojo.forEach(this.formWidgets[a].connections,this.disconnect,this),delete this.formWidgets[a]);return this},registerWidgetDescendants:function(a){typeof a=="string"?a=dijit.byId(a):a.tagName&&a.cloneNode&&(a=dijit.byNode(a));var b=dojo.map(a.getDescendants(),f,this);dojo.forEach(b,function(a){a&&h.call(this,a,g.call(this,a))},this);return this.registerNodeDescendants?this.registerNodeDescendants(a.domNode):this},unregisterWidgetDescendants:function(a){typeof a=="string"?a=dijit.byId(a):a.tagName&&a.cloneNode&&(a=dijit.byNode(a)),dojo.forEach(dojo.map(a.getDescendants(),function(a){return a instanceof dijit.form._FormWidget&&a.get("name")||null}),function(a){a&&this.unregisterNode(a)},this);return this.unregisterNodeDescendants?this.unregisterNodeDescendants(a.domNode):this},formWidgetValue:function(a,b){var c=arguments.length==2&&b!==undefined,d;typeof a=="string"&&(a=this.formWidgets[a],a&&(a=a.widget));if(!a)return null;if(dojo.isArray(a)){if(c){dojo.forEach(a,function(a){a.set("checked",!1,!this.watching)}),dojo.forEach(a,function(a){a.set("checked",a.value===b,!this.watching)});return this}dojo.some(a,function(a){if(dojo.attr(a.focusNode,"checked")){d=a;return!0}return!1});return d?d.get("value"):""}if(a.declaredClass=="dijit.form.CheckBox"){if(c){a.set("value",Boolean(b),!this.watching);return this}return Boolean(a.get("value"))}if(c){a.set("value",b,!this.watching);return this}return a.get("value")},formPointValue:function(a,b){a&&typeof a=="string"&&(a=this[a]);if(!a||!a.tagName||!a.cloneNode)return null;if(!dojo.hasClass(a,"dojoFormValue"))return null;if(arguments.length==2&&b!==undefined){a.innerHTML=b;return this}return a.innerHTML},inspectFormWidgets:function(a,b,c){var d,e={};if(b)if(dojo.isArray(b))dojo.forEach(b,function(b){b in this.formWidgets&&(e[b]=a.call(this,b,this.formWidgets[b].widget,c))},this);else for(d in b)d in this.formWidgets&&(e[d]=a.call(this,d,this.formWidgets[d].widget,b[d]));else for(d in this.formWidgets)e[d]=a.call(this,d,this.formWidgets[d].widget,c);return e},inspectAttachedPoints:function(a,b,c){var e,f={};if(b)if(dojo.isArray(b))dojo.forEach(b,function(b){var d=this[b];d&&d.tagName&&d.cloneNode&&(f[b]=a.call(this,b,d,c))},this);else for(e in b){var g=this[e];g&&g.tagName&&g.cloneNode&&(f[e]=a.call(this,e,g,b[e]))}else for(e in this)if(!(e in d)){var g=this[e];g&&g.tagName&&g.cloneNode&&(f[e]=a.call(this,e,g,c))}return f},inspect:function(a,b,c){var d=this.inspectFormWidgets(function(b,c,d){if(dojo.isArray(c))return a.call(this,b,dojo.map(c,function(a){return a.domNode}),d);return a.call(this,b,c.domNode,d)},b,c);this.inspectFormNodes&&dojo.mixin(d,this.inspectFormNodes(a,b,c));return dojo.mixin(d,this.inspectAttachedPoints(a,b,c))}})}(),dojo.extend(dijit._Widget,{observer:""})