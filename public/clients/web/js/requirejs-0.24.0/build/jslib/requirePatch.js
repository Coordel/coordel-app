define(["env!env/file","pragma","parse"],function(file,pragma,parse){var allowRun=!0;return function(){if(allowRun){allowRun=!1;var layer,pluginBuilderRegExp=/(["']?)pluginBuilder(["']?)\s*[=\:]\s*["']([^'"\s]+)["']/,oldDef;require._buildReset=function(){var a=require.s.contexts._;delete require.s.contexts._,require({}),layer=require._layer={buildPathMap:{},buildFileToModule:{},buildFilePaths:[],loadedFiles:{},modulesWithNames:{},existingRequireUrl:"",context:require.s.contexts._},layer.context.pluginBuilders={},layer.context._plugins={};return a},require._buildReset(),require._isSupportedBuildUrl=function(a){return a.indexOf("://")===-1&&a.indexOf("?")===-1},oldDef=require.def,define=require.def=function(a,b){typeof a==="string"&&(layer.modulesWithNames[a]=!0);return oldDef.apply(require,arguments)},require._readFile=file.readFile,require._fileExists=function(a){return file.exists(a)},require.load=function(context,moduleName,url){var contents,pluginBuilderMatch,builderName;require.jsExtRegExp.test(moduleName)&&(url=context.config.dirBaseUrl+url),context.loaded[moduleName]=!1,context.scriptCount+=1,require._isSupportedBuildUrl(url)&&(layer.buildPathMap[moduleName]=url,layer.buildFileToModule[url]=moduleName,contents=file.readFile(url),contents=pragma.process(url,contents,context.config),!layer.existingRequireUrl&&parse.definesRequire(url,contents)&&(layer.existingRequireUrl=url),moduleName in context.plugins&&(pluginBuilderMatch=pluginBuilderRegExp.exec(contents),pluginBuilderMatch&&(builderName=context.normalize(pluginBuilderMatch[3],moduleName),contents=file.readFile(context.nameToUrl(builderName))),context._plugins[moduleName]=!0),context._plugins[moduleName]||(contents=parse(url,contents)),contents&&(eval(contents),context.completeLoad(moduleName)),layer.buildFilePaths.push(url)),context.loaded[moduleName]=!0,context._plugins[moduleName]&&(context.pluginBuilders[moduleName]=context.defined[moduleName])},require.onPluginLoad=function(a,b,c,d){var e=b+"!"+c;layer.buildFilePaths.push(e),layer.buildFileToModule[e]=e,layer.modulesWithNames[e]=!0},require.execCb=function(a,b,c){var d=a&&layer.buildPathMap[a];d&&!layer.loadedFiles[d]&&(layer.loadedFiles[d]=!0,layer.modulesWithNames[a]=!0);if(b.__requireJsBuild||layer.context._plugins[a])return b.apply(null,c);return undefined}}}})