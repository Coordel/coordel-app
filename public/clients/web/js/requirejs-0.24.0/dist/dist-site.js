require(["logger","env!env/file","child_process"],function(a,b,c){function s(){e=d[r],r+=1;e&&(f=e+".trans",a.trace("Creating "+e),c.exec("./Markdown.pl --html4tags "+e+" > "+f,function(c,d,r){if(c)a.error("Could not markdown "+e),s();else{g=b.readFile(f),g=h+g+i,j=g.match(/<h1>([^<]+)<\/h1>/),j&&j[1]?j=j[1]:j="",g=g.replace(/\$\{title\}/,j),g=g.replace(/href="requirejs\/tree\/master\/docs\//g,'href="docs/').replace(/href="([^"]+)\.md/g,'href="$1.html'),k=e.replace(/\/[^\/]+$/,"").replace(/^\.\/dist-site\//,"");if(k&&k!=="dist-site"){q=!1,o=k.split("/").length,k="";for(p=0;p<o-1;p++)k+="../";l=k+"main.css",m=k+"ie.css",n=k+"init.js"}else q=!0,k="./",l="main.css",m="ie.css",n="init.js";g=g.replace(/HOMEPATH/g,k),g=g.replace(/\main\.css/,l),g=g.replace(/\ie\.css/,m),g=g.replace(/\init\.js/,n),q&&(g=g.replace(/href="\.\.\/"/g,'href="./"').replace(/class="local" href="([^"]+)"/g,'class="local" href="docs/$1"')),b.saveFile(e,g),b.deleteFile(f),s()}}))}var d,e,f,g,h,i,j,k,l,m,n,o,p,q=!1,r=0;b.copyFile("main.css","./dist-site/main.css"),b.copyFile("ie.css","./dist-site/ie.css"),b.copyFile("init.js","./dist-site/init.js"),b.copyDir("fonts","./dist-site/fonts",/\w/),b.copyFile("../index.html","./dist-site/index.html"),b.copyDir("../docs/","./dist-site/docs/",/\w/),h=b.readFile("pre.html"),i=b.readFile("post.html"),d=b.getFilteredFileList("./dist-site",/\.html$/,!0),s()})